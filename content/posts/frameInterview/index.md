---
title: "ğŸ’» å‰ç«¯é¢è¯•é¢˜æ±‡æ€»"
date: 2024-08-10T10:00:39+08:00
tags: ["é¢è¯•"]
categories: ["é¢è¯•"]
---

æœ¬ç¯‡æ–‡ç« æ—¨åœ¨åˆ©ç”¨ä¸€å¤©æ—¶é—´ï¼Œå‰–æç»å…¸å‰ç«¯ç»å…¸é¢è¯•é¢˜ï¼Œå¸¦ä½ å¿«é€Ÿå»ºç«‹å‰ç«¯é¢è¯•çŸ¥è¯†ä½“ç³»ï¼Œè®©é¢è¯•æ›´åŠ  "æœ‰åº•æ°”"ï¼Œæ¬¢è¿æ‚¨çš„æŒ‡æ­£å’Œç‚¹èµã€‚

<!--more-->

## HTML

### å¦‚ä½•ç†è§£ HTML è¯­ä¹‰åŒ–

- è®©äººæ›´å®¹æ˜“è¯»æ‡‚ï¼ˆä»£ç å¯è¯»æ€§ï¼‰
- è®©æœç´¢å¼•æ“æ›´å®¹æ˜“è¯»æ‡‚ï¼ˆSEOï¼‰

### é»˜è®¤æƒ…å†µä¸‹ï¼Œå“ªäº› HTML æ ‡ç­¾æ˜¯å—çº§å…ƒç´ ï¼Œå“ªäº›æ˜¯å†…è”å…ƒç´ 

- display: block/tableï¼šdivã€h1 - h6ã€tableã€ulã€olã€p ç­‰
- display: inline/inline-blockï¼šimgã€spanã€inputã€button ç­‰

## CSS

### å¸ƒå±€

#### ç›’å­æ¨¡å‹çš„å®½åº¦å¦‚ä½•è®¡ç®—

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%207.png" alt="" width="100%" />

ç­”æ¡ˆï¼šoffsetWidth = 122px = å†…å®¹å®½åº¦ + å†…è¾¹è· + è¾¹æ¡†

è¡¥å……ï¼šå¦‚æœè®© offsetWidth ç­‰äº 100pxï¼Œè¯¥å¦‚ä½•åšï¼Ÿ

ç­”æ¡ˆï¼šbox-sizing: border-box

#### margin çºµå‘é‡å çš„é—®é¢˜

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%208.png" alt="" width="100%" />

- ç›¸é‚»å…ƒç´ çš„ margin-top å’Œ margin-bottom ä¼šå‘ç”Ÿé‡å 
- ç©ºç™½å†…å®¹çš„ <p></p>ä¹Ÿä¼šé‡å 

ç­”æ¡ˆï¼š15px

#### margin è´Ÿå€¼çš„é—®é¢˜

- margin-top å’Œ margin-left è´Ÿå€¼ï¼Œå…ƒç´ å‘ä¸Šã€å‘å·¦ç§»åŠ¨
- margin-right è´Ÿå€¼ï¼Œè‡ªèº«ä¸å—å½±å“ï¼Œå³ä¾§å…ƒç´ å·¦ç§»
- margin-bottom è´Ÿå€¼ï¼Œè‡ªèº«ä¸å—å½±å“ï¼Œä¸‹æ–¹å…ƒç´ ä¸Šç§»

#### BFC ç†è§£å’Œåº”ç”¨

å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼Œä¸€å—ç‹¬ç«‹çš„æ¸²æŸ“åŒºåŸŸï¼Œå†…éƒ¨å…ƒç´ çš„æ¸²æŸ“ä¸ä¼šå½±å“è¾¹ç•Œä»¥å¤–çš„å…ƒç´ ã€‚

å½¢æˆ BFC çš„å¸¸è§æ¡ä»¶ï¼š

- float ä¸æ˜¯ none
- position æ˜¯ absolute æˆ– fixed
- overflow ä¸æ˜¯ visible
- display æ˜¯ flexã€inline-block ç­‰

BFC çš„å¸¸è§åº”ç”¨

- æ¸…é™¤æµ®åŠ¨

#### float å¸ƒå±€çš„é—®é¢˜ï¼Œä»¥åŠæ‰‹å†™ clearfix

åœ£æ¯å¸ƒå±€å’ŒåŒé£ç¿¼å¸ƒå±€ï¼š

- ä¸‰æ å¸ƒå±€ï¼Œä¸­é—´ä¸€æ æœ€å…ˆåŠ è½½å’Œæ¸²æŸ“
- ä¸¤ä¾§å†…å®¹å›ºå®šï¼Œä¸­é—´å†…å®¹éšå®½åº¦è‡ªé€‚åº”

æŠ€æœ¯å®ç°ï¼š

- ä½¿ç”¨ float å¸ƒå±€
- ä¸¤ä¾§ä½¿ç”¨ margin è´Ÿå€¼ï¼Œä»¥ä¾¿å’Œä¸­é—´å†…å®¹æ¨ªå‘é‡å 
- é˜²æ­¢ä¸­é—´å†…å®¹è¢«ä¸¤ä¾§è¦†ç›–ï¼Œä¸€ä¸ªç”¨ padding ä¸€ä¸ªç”¨ margin

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%209.png" alt="" width="100%" />

#### flex ç”»è‰²å­

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2010.png" alt="" width="100%" />

### å®šä½

#### absolute å’Œ relative åˆ†åˆ«ä¾æ®ä»€ä¹ˆå®šä½

- relative ä¾æ®è‡ªèº«å®šä½
- absolute ä¾æ®æœ€è¿‘ä¸€å±‚çš„å®šä½å…ƒç´ ï¼ˆabsoluteã€relativeã€fixedã€bodyï¼‰å®šä½

#### å±…ä¸­å¯¹é½æœ‰å“ªäº›å®ç°æ–¹å¼

æ°´å¹³å±…ä¸­ï¼š

- inline å…ƒç´ ï¼štext-align: center
- block å…ƒç´ ï¼šmargin: auto
- absolute å…ƒç´ ï¼šleft: 50% + margin-left è´Ÿå€¼

å‚ç›´å±…ä¸­ï¼š

- inline å…ƒç´ ï¼šline-height çš„å€¼ç­‰äº height çš„å€¼
- absolute å…ƒç´ ï¼štop: 50% + margin-top è´Ÿå€¼
- absolute å…ƒç´ ï¼štransform: translate(-50%, -50%)
- absolute å…ƒç´ ï¼štopã€leftã€bottomã€right = 0 + margin: auto

### å›¾æ–‡æ ·å¼

#### line-height çš„ç»§æ‰¿é—®é¢˜

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2011.png" alt="" width="100%" />

- å†™å…·ä½“æ•°å€¼ï¼Œå¦‚ 30pxï¼Œåˆ™ç»§æ‰¿è¯¥å€¼
- å†™æ¯”ä¾‹ï¼Œå¦‚ 2ï¼Œåˆ™ç»§æ‰¿è¯¥æ¯”ä¾‹
- å†™ç™¾åˆ†æ¯”ï¼Œå¦‚ 200%ï¼Œåˆ™ç»§æ‰¿è®¡ç®—å‡ºæ¥çš„å€¼

### å“åº”å¼

#### rem æ˜¯ä»€ä¹ˆï¼Ÿ

- pxï¼Œç»å¯¹é•¿åº¦å•ä½ï¼Œæœ€å¸¸ç”¨
- emï¼Œç›¸å¯¹é•¿åº¦å•ä½ï¼Œç›¸å¯¹äºçˆ¶å…ƒç´ ï¼Œä¸å¸¸ç”¨
- remï¼Œç›¸å¯¹é•¿åº¦å•ä½ï¼Œç›¸å¯¹äºæ ¹å…ƒç´ ï¼Œå¸¸ç”¨äºå“åº”å¼å¸ƒå±€

#### å¦‚ä½•å®ç°å“åº”å¼

- media-queryï¼Œæ ¹æ®ä¸åŒçš„å±å¹•å®½åº¦è®¾ç½®æ ¹å…ƒç´ çš„ font-size
- remï¼ŒåŸºäºæ ¹å…ƒç´ çš„ç›¸å¯¹å•ä½

## JS åŸºç¡€

### å˜é‡ç±»å‹å’Œè®¡ç®—

#### typeof èƒ½åˆ¤æ–­å“ªäº›ç±»å‹

- è¯†åˆ«æ‰€æœ‰å€¼ç±»å‹
- è¯†åˆ«å‡½æ•°
- åˆ¤æ–­æ˜¯å¦æ˜¯å¼•ç”¨ç±»å‹ï¼ˆä¸å¯å†ç»†åˆ†ï¼‰

#### ä½•æ—¶ä½¿ç”¨ === ä½•æ—¶ä½¿ç”¨ ==

é™¤äº† == nullï¼ˆnull == undefinedï¼‰ å¤–ï¼Œå…¶ä»–éƒ½ä¸€å¾‹ç”¨ ===

#### å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„åŒºåˆ«

å€¼ç±»å‹ï¼šæ ˆ

å¼•ç”¨ç±»å‹ï¼šæ ˆ + å †

å€¼ç±»å‹ / å¼•ç”¨ç±»å‹çš„æ‹·è´

#### æ‰‹å†™æ·±æ‹·è´ â­ï¸

- åˆ¤æ–­å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹
- åˆ¤æ–­æ˜¯æ•°ç»„è¿˜æ˜¯å¯¹è±¡
- é€’å½’

```javascript
function deepClone(obj = {}) {
  if (typeof obj !== "object" || obj == null) {
    return obj;
  }

  let result = Array.isArray(obj) ? [] : {};

  for (let key in obj) {
    // è‡ªå·±çš„å±æ€§
    if (obj.hasOwnProperty(key)) {
      // é€’å½’è°ƒç”¨
      result[key] = deepClone(obj[key]);
    }
  }

  return result;
}
```

### åŸå‹å’ŒåŸå‹é“¾

#### å¦‚ä½•å‡†ç¡®åˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯ä¸æ˜¯æ•°ç»„

- a instanceof Array
- Array.isArray()

#### class çš„åŸå‹æœ¬è´¨ï¼Œæ€ä¹ˆç†è§£

class å®é™…ä¸Šæ˜¯å‡½æ•°ï¼Œè¯­æ³•ç³–

- æ¯ä¸ª class éƒ½æœ‰æ˜¾ç¤ºåŸå‹ prototype
- æ¯ä¸ªå®ä¾‹éƒ½æœ‰éšå¼åŸå‹ **proto**
- å®ä¾‹çš„ **proto** æŒ‡å‘å¯¹åº” class çš„ prototype

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2012.png" alt="" width="100%" />

#### æ‰‹å†™ä¸€ä¸ªç®€æ˜“çš„ jQueryï¼Œè€ƒè™‘æ’ä»¶å’Œæ‰©å±•æ€§

```javascript
class jQuery {
  constructor(selector) {
    const result = document.querySelectorAll(selector);
    const length = result.length;
    for (let i = 0; i < length; i++) {
      this[i] = result[i];
    }
    this.length = length;
    this.selector = selector;
  }

  get(index) {
    return this[index];
  }

  each(fn) {
    for (let i = 0; i < this.length; i++) {
      const elem = this[i];
      fn(elem);
    }
  }

  on(type, fn) {
    return this.each((elem) => {
      elem.addEventListener(type, fn, false);
    });
  }
}

// æ’ä»¶
jQuery.prototype.dialog = function (info) {
  alert(info);
};

// "é€ è½®å­"
class MyJQuery extends jQuery {
  constructor(selector) {
    super(selector);
  }
  // æ‰©å±•è‡ªå·±çš„æ–¹æ³•
  addClass(className) {
    // ...
  }
}
```

### ä½œç”¨åŸŸå’Œé—­åŒ…

#### this çš„ä¸åŒåº”ç”¨åœºæ™¯ï¼Œå¦‚ä½•å–å€¼ â­ï¸

**this çš„å–å€¼æ˜¯åœ¨å‡½æ•°æ‰§è¡Œæ—¶ç¡®å®šï¼Œä¸æ˜¯åœ¨å‡½æ•°å®šä¹‰æ—¶ç¡®å®šï¼ï¼ï¼**

- å½“åšæ™®é€šå‡½æ•°è¢«è°ƒç”¨ï¼ˆwindowï¼‰
- ä½¿ç”¨ callã€applyã€bindï¼ˆä¼ å…¥çš„å¯¹è±¡ï¼‰
- ä½œä¸ºå¯¹è±¡æ–¹æ³•è¢«è°ƒç”¨ï¼ˆå¯¹è±¡ï¼‰
- åœ¨ class çš„æ–¹æ³•ä¸­è°ƒç”¨
- ç®­å¤´å‡½æ•°ï¼ˆå®šä¹‰æ—¶çš„ä¸Šçº§ä½œç”¨åŸŸï¼‰

#### æ‰‹å†™ bind å‡½æ•° â­ï¸

```javascript
Function.prototype.bind = function () {
  // å°†å‚æ•°æ‹†è§£ä¸ºæ•°ç»„
  const args = Array.prototype.slice.call(arguments);

  // è·å– this(æ•°ç»„ç¬¬ä¸€é¡¹)
  const t = args.shift();

  // fn.bind(...) ä¸­çš„ fn
  const self = this;

  // è¿”å›ä¸€ä¸ªå‡½æ•°
  return function () {
    return self.apply(t, args);
  };
};
```

#### å®é™…å¼€å‘ä¸­é—­åŒ…çš„åº”ç”¨åœºæ™¯ï¼Œä¸¾ä¾‹è¯´æ˜

- éšè—æ•°æ®ï¼Œåªæä¾› API

```javascript
function createCache() {
  const data = {};
  return {
    set: function (key, val) {
      data[key] = val;
    },
    get: function (key) {
      return data[key];
    },
  };
}
```

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2013.png" alt="" width="100%" />

**é—­åŒ…ï¼šæ‰€æœ‰çš„è‡ªç”±å˜é‡çš„æŸ¥æ‰¾ï¼Œæ˜¯åœ¨å‡½æ•°å®šä¹‰çš„åœ°æ–¹ï¼Œå‘ä¸Šçº§ä½œç”¨åŸŸæŸ¥æ‰¾ï¼Œä¸æ˜¯åœ¨æ‰§è¡Œçš„åœ°æ–¹ï¼ˆé™æ€ä½œç”¨åŸŸï¼‰ï¼ï¼ï¼**

ç­”æ¡ˆï¼š100, 100

### å¼‚æ­¥

#### åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ

- åŸºäº JS æ˜¯å•çº¿ç¨‹è¯­è¨€
- å¼‚æ­¥ä¸ä¼šé˜»å¡ä»£ç æ‰§è¡Œ
- åŒæ­¥ä¼šé˜»å¡ä»£ç æ‰§è¡Œ

#### æ‰‹å†™ç”¨ Promise åŠ è½½ä¸€å¼ å›¾ç‰‡ â­ï¸

```javascript
function loadImg(src) {
  return new Promise((resolve, reject) => {
    const img = document.createElement("img");
    img.onload = () => {
      resolve(img);
    };
    img.onerror = () => {
      reject(new Error("å›¾ç‰‡åŠ è½½å¤±è´¥"));
    };
    img.src = src;
  });
}
```

Callback Hell

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2014.png" alt="" width="100%" />

#### å‰ç«¯ä½¿ç”¨å¼‚æ­¥çš„åœºæ™¯æœ‰å“ªäº›ï¼Ÿ

- ç½‘ç»œè¯·æ±‚ï¼Œå¦‚ ajax å›¾ç‰‡åŠ è½½
- å®šæ—¶ä»»åŠ¡ï¼Œå¦‚ setTimeoutã€setInterval

#### åœºæ™¯é¢˜

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2015.png" alt="" width="100%" />

ç­”æ¡ˆï¼š1ã€3ã€5ã€4ã€2

### å¼‚æ­¥è¿›é˜¶

#### è¯·æè¿° event loop çš„æœºåˆ¶ï¼Œå¯ç”»å›¾ â­ï¸

- åŒæ­¥ä»£ç ï¼Œä¸€è¡Œä¸€è¡Œæ”¾åœ¨ Call Stack ä¸­æ‰§è¡Œ
- é‡åˆ°å¼‚æ­¥ï¼Œä¼šå…ˆ â€œè®°å½•â€ ä¸‹ï¼Œç­‰å¾…æ—¶æœºï¼ˆå®šæ—¶ã€ç½‘ç»œè¯·æ±‚ç­‰ï¼‰
- æ—¶æœºåˆ°äº†ï¼Œå°±ç§»åŠ¨åˆ° Callback Queue
- å¦‚æœ Call Stack ä¸ºç©ºï¼ˆå³åŒæ­¥ä»£ç æ‰§è¡Œå®Œï¼‰ï¼ŒEvent Loop å¼€å§‹å·¥ä½œ
- è½®è¯¢æŸ¥æ‰¾ Callback Queueï¼Œå¦‚æœ‰åˆ™ç§»åŠ¨åˆ° Call Stack æ‰§è¡Œ
- ç„¶åç»§ç»­è½®è¯¢æŸ¥æ‰¾ï¼ˆæ°¸åŠ¨æœºï¼‰

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2016.png" alt="" width="100%" />

#### Promise æœ‰å“ªä¸‰ç§çŠ¶æ€ï¼Œå¦‚ä½•å˜åŒ–

ä¸‰ç§çŠ¶æ€ï¼š

- pendingã€resolvedã€rejected
- pending â†’ resolved æˆ– pending â†’ rejected
- å˜åŒ–ä¸å¯é€†

çŠ¶æ€è¡¨ç°ï¼š

- pending çŠ¶æ€ï¼Œä¸ä¼šè§¦å‘ then å’Œ catch
- resolved çŠ¶æ€ï¼Œä¼šè§¦å‘åç»­çš„ then å›è°ƒå‡½æ•°
- rejected çŠ¶æ€ï¼Œä¼šè§¦å‘åç»­çš„ catch å›è°ƒå‡½æ•°

#### async/await å’Œ Promise çš„å…³ç³»

- æ‰§è¡Œ async å‡½æ•°ï¼Œè¿”å›çš„æ˜¯ Promise å¯¹è±¡
- await ç›¸å½“äº Promise çš„ then
- tryâ€¦catch å¯æ•è·å¼‚å¸¸ï¼Œä»£æ›¿äº† Promise çš„ catch

#### Event Loop å’Œ DOM æ¸²æŸ“

- JS æ˜¯å•çº¿ç¨‹ï¼Œè€Œä¸”å’Œ DOM æ¸²æŸ“å…±ç”¨ä¸€ä¸ªçº¿ç¨‹
- JS æ‰§è¡Œæ—¶ï¼Œå¾—ç•™ä¸€äº›æ—¶æœºä¾› DOM æ¸²æŸ“
- æ¯æ¬¡ Call Stack æ¸…ç©ºï¼Œå³åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œ
- éƒ½æ˜¯ DOM é‡æ–°æ¸²æŸ“çš„æœºä¼šï¼ŒDOM ç»“æ„å¦‚æœ‰æ”¹å˜åˆ™é‡æ–°æ¸²æŸ“
- ç„¶åå†å»è§¦å‘ä¸‹ä¸€æ¬¡ Event Loop

#### ä»€ä¹ˆæ˜¯å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡ï¼Œä¸¤è€…æœ‰ä»€ä¹ˆåŒºåˆ«

- å®ä»»åŠ¡ï¼šsetTimeoutã€setIntervalã€ajaxã€dom äº‹ä»¶
- å¾®ä»»åŠ¡ï¼šPromiseã€async/await
- å¾®ä»»åŠ¡æ‰§è¡Œæ—¶æœºæ¯”å®ä»»åŠ¡è¦æ—©
- å®ä»»åŠ¡åœ¨ DOM æ¸²æŸ“åè§¦å‘ï¼Œå¦‚ setTimeout
- å¾®ä»»åŠ¡åœ¨ DOM æ¸²æŸ“å‰è§¦å‘ï¼Œå¦‚ Promsie

#### æ‰‹å†™ Promiseâ­ï¸

- åˆå§‹åŒ– & å¼‚æ­¥è°ƒç”¨
- then catch é“¾å¼è°ƒç”¨
- API .resolve .reject .all .race

```javascript
class MyPromise {
  state = "pending";
  value = undefined;
  reason = undefined;

  resolveCallbacks = []; // pending çŠ¶æ€ä¸‹ï¼Œå­˜å‚¨æˆåŠŸçš„å›è°ƒ
  rejectCallbacks = []; // pending çŠ¶æ€ä¸‹ï¼Œå­˜å‚¨å¤±è´¥çš„å›è°ƒ

  constructor(fn) {
    const resolveHandler = (value) => {
      if (this.state === "pending") {
        this.state = "fulfilled";
        this.value = value;
        this.resolveCallbacks.forEach((fn) => fn(this.value));
      }
    };

    const rejectHandler = (reason) => {
      if (this.state === "pending") {
        this.state = "rejected";
        this.reason = reason;
        this.rejectCallbacks.forEach((fn) => fn(this.reason));
      }
    };

    try {
      fn(resolveHandler, rejectHandler);
    } catch (err) {
      rejectHandler(err);
    }
  }

  then(fn1, fn2) {
    // pending çŠ¶æ€ä¸‹ï¼Œfn1ã€fn2 è¢«ä¿å­˜
    fn1 = typeof fn1 === "function" ? fn1 : (v) => v;
    fn2 = typeof fn2 === "function" ? fn2 : (e) => e;

    if (this.state === "pending") {
      return new MyPromise((resolve, reject) => {
        this.resolveCallbacks.push(() => {
          try {
            const newValue = fn1(this.value);
            resolve(newValue);
          } catch (err) {
            reject(err);
          }
        });

        this.rejectCallbacks.push(() => {
          try {
            const newReason = fn2(this.reason);
            reject(newReason);
          } catch (err) {
            reject(err);
          }
        });
      });
    }

    if (this.state === "fulfilled") {
      return new MyPromise((resolve, reject) => {
        try {
          const newValue = fn1(this.value);
          resolve(newValue);
        } catch (err) {
          reject(err);
        }
      });
    }

    if (this.state === "rejected") {
      return new MyPromise((resolve, reject) => {
        try {
          const newReason = fn2(this.reason);
          reject(newReason);
        } catch (err) {
          reject(err);
        }
      });
    }
  }

  catch(fn) {
    return this.then(null, fn);
  }
}

MyPromise.resolve = function (value) {
  return new MyPromise((resolve, reject) => resolve(value));
};

MyPromise.reject = function (reason) {
  return new MyPromise((resolve, reject) => reject(reason));
};

MyPromise.all = function (promiseList = []) {
  return new MyPromise((resolve, reject) => {
    const result = [];
    const length = promiseList.length;
    let resolveCount = 0;
    promiseList.forEach((p) => {
      p.then((data) => {
        result.push(data);
        // resolveCount å¿…é¡»åœ¨ then é‡Œé¢åš ++
        resolveCount++;
        if (resolveCount === length) {
          resolve(result);
        }
      }).catch((err) => {
        reject(err);
      });
    });
  });
};

MyPromise.race = function (promiseList = []) {
  let resolved = false;
  return new MyPromise((resolve, reject) => {
    promiseList.forEach((p) => {
      p.then((data) => {
        if (!resolved) {
          resolve(data);
          resolved = true;
        }
      }).catch((err) => {
        reject(err);
      });
    });
  });
};
```

#### åœºæ™¯é¢˜

then å’Œ catch æ”¹å˜çŠ¶æ€ï¼š

- then æ­£å¸¸è¿”å› resolved promiseï¼Œé‡Œé¢æœ‰æŠ¥é”™åˆ™è¿”å› rejected promise
- catch æ­£å¸¸è¿”å› resolved promiseï¼Œé‡Œé¢æœ‰æŠ¥é”™åˆ™è¿”å› rejected promise

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2017.png" alt="" width="100%" />

ç¬¬ä¸€é¢˜ï¼š1ã€3

ç¬¬äºŒé¢˜ï¼š1ã€2ã€3

ç¬¬ä¸‰é¢˜ï¼š1ã€2

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2018.png" alt="" width="100%" />

ç¬¬ä¸€é¢˜ï¼ša â†’ Promise å¯¹è±¡ã€b â†’ 100

ç¬¬äºŒé¢˜ï¼šâ€˜startâ€™ã€100ã€200ã€æŠ¥é”™â€¦

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2019.png" alt="" width="100%" />

ç­”æ¡ˆï¼š100ã€400ã€300ã€200

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2020.png" alt="" width="100%" />

ç­”æ¡ˆï¼šâ€˜script startâ€™ â†’ â€˜async1 startâ€™ â†’ â€˜async2â€™ â†’ â€˜promise1â€™ â†’ â€˜script endâ€™ â†’ â€˜async1 endâ€™ â†’ â€˜promise2â€™ â†’ â€˜setTimeoutâ€™

æ‰§è¡Œæ—¶æœºï¼š**åŒæ­¥ä»£ç æ‰§è¡Œå®Œæ¯• â†’ æ‰§è¡Œå¾®ä»»åŠ¡ â†’ è§¦å‘ DOM æ¸²æŸ“ â†’ è§¦å‘ Event Loopï¼Œæ‰§è¡Œå®ä»»åŠ¡ã€‚**

è¦ç‚¹ï¼š**åˆå§‹åŒ– promise æ—¶ï¼Œä¼ å…¥çš„å‡½æ•°ä¼šç«‹åˆ»è¢«æ‰§è¡Œï¼›await åé¢çš„éƒ½ä½œä¸ºå›è°ƒå†…å®¹ï¼ˆå¾®ä»»åŠ¡ï¼‰ã€‚**

## JS-Web-API

### DOM

#### DOM æ˜¯å“ªç§æ•°æ®ç»“æ„

æ ‘ï¼ˆDOM æ ‘ï¼‰

#### attribute å’Œ property çš„åŒºåˆ«

- propertyï¼šä¿®æ”¹å¯¹è±¡å±æ€§ï¼Œä¸ä¼šä½“ç°åˆ° html ç»“æ„ä¸­
- attributeï¼šä¿®æ”¹ html å±æ€§ï¼Œä¼šæ”¹å˜ html ç»“æ„
- ä¸¤è€…éƒ½æœ‰å¯èƒ½å¼•èµ· DOM é‡æ–°æ¸²æŸ“

#### ä¸€æ¬¡æ€§æ’å…¥å¤šä¸ª DOM èŠ‚ç‚¹ï¼Œè€ƒè™‘æ€§èƒ½

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2021.png" alt="" width="100%" />

### BOM

#### åˆ†ææ‹†è§£ url å„ä¸ªéƒ¨åˆ†

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2022.png" alt="" width="100%" />

### äº‹ä»¶

#### ç¼–å†™ä¸€ä¸ªé€šç”¨çš„äº‹ä»¶ç›‘å¬å‡½æ•°

```javascript
function bindEvent(elem, type, selector, fn) {
  if (fn == null) {
    fn = selector;
    selector = null;
  }
  elem.addEventListener(type, (event) => {
    const target = event.target;
    if (selector) {
      // ä»£ç†ç»‘å®š
      if (target.matches(selector)) {
        fn.call(target, event);
      }
    } else {
      // æ™®é€šç»‘å®š
      fn.call(target, event);
    }
  });
}
```

#### æè¿°äº‹ä»¶å†’æ³¡çš„æµç¨‹

- åŸºäº DOM æ ‘å½¢ç»“æ„
- äº‹ä»¶ä¼šé¡ºç€è§¦å‘å…ƒç´ å‘ä¸Šå†’æ³¡
- åº”ç”¨åœºæ™¯ï¼šä»£ç†

#### æ— é™ä¸‹æ‹‰çš„å›¾ç‰‡åˆ—è¡¨ï¼Œå¦‚ä½•ç›‘å¬æ¯ä¸ªå›¾ç‰‡çš„ç‚¹å‡»

- äº‹ä»¶ä»£ç†
- ç”¨ [event.target](http://event.target) æ¥è·å–è§¦å‘å…ƒç´ 
- ç”¨ matches æ¥åˆ¤æ–­æ˜¯å¦æ˜¯è§¦å‘å…ƒç´ 

### Ajax

#### æ‰‹å†™ä¸€ä¸ªç®€æ˜“çš„ ajax

```javascript
function ajax(url) {
  return new Promise((resolve, reject) => {
    const xhr = new XMLHttpRequest();
    xhr.open("GET", url, true);
    xhr.onreadystatechange = function () {
      if (xhr.readyState === 4) {
        if (xhr.status === 200) {
          resolve(JSON.parse(xhr.responseText));
        } else if (xhr.status === 404) {
          reject(new Error("404 not found"));
        }
      }
    };
    xhr.send(null);
  });
}
```

#### è·¨åŸŸçš„å¸¸ç”¨æ–¹å¼

JSONPï¼š

- \<script\> å¯ç»•è¿‡è·¨åŸŸé™åˆ¶
- æœåŠ¡å™¨å¯ä»¥ä»»æ„åŠ¨æ€æ‹¼æ¥æ•°æ®è¿”å›
- æ‰€ä»¥ï¼Œ\<script\>å°±å¯ä»¥è·å¾—è·¨åŸŸçš„æ•°æ®ï¼Œåªè¦æœåŠ¡ç«¯æ„¿æ„è¿”å›

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2023.png" alt="" width="100%" />

CORSï¼š

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2024.png" alt="" width="100%" />

### å­˜å‚¨

#### æè¿° cookieã€localStorageã€sessionStorage åŒºåˆ«

- å®¹é‡ï¼šcookie 4kbï¼ŒlocalStorage/sessionStorage 5M
- API æ˜“ç”¨æ€§ï¼šcookie document.cookieï¼ŒlocalStorage/sessionStorage setItemã€getItem
- æ˜¯å¦è·Ÿéš http è¯·æ±‚å‘é€å‡ºå»

## http

### http

#### http å¸¸è§çš„çŠ¶æ€ç æœ‰å“ªäº›

- 1xx æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚
- 2xx è¯·æ±‚æˆåŠŸï¼Œå¦‚ 200ï¼ˆæˆåŠŸï¼‰
- 3xx é‡å®šå‘ï¼Œå¦‚ 301ï¼ˆæ°¸ä¹…é‡å®šå‘ï¼‰302ï¼ˆä¸´æ—¶é‡å®šå‘ï¼‰304ï¼ˆèµ„æºæœªè¢«ä¿®æ”¹ï¼‰
- 4xx å®¢æˆ·ç«¯è¯·æ±‚é”™è¯¯ï¼Œå¦‚ 403ï¼ˆæ²¡æœ‰æƒé™ï¼‰404ï¼ˆèµ„æºæœªæ‰¾åˆ°ï¼‰
- 5xx æœåŠ¡ç«¯é”™è¯¯ï¼Œå¦‚ 500ï¼ˆæœåŠ¡å™¨é”™è¯¯ï¼‰504ï¼ˆç½‘å…³è¶…æ—¶ï¼‰

#### http å¸¸è§çš„ header æœ‰å“ªäº›

request headers:

- Accept æµè§ˆå™¨å¯æ¥æ”¶çš„æ•°æ®æ ¼å¼
- Accept-Encoding æµè§ˆå™¨å¯æ¥æ”¶çš„å‹ç¼©ç®—æ³•ï¼Œå¦‚ gzip
- Accept-Languange æµè§ˆå™¨å¯æ¥æ”¶çš„è¯­è¨€ï¼Œå¦‚ zh-CN
- Connection: keep-alive ä¸€æ¬¡ TCP è¿æ¥é‡å¤ä½¿ç”¨
- Host
- cookie
- User-Agent æµè§ˆå™¨ä¿¡æ¯
- Content-type å‘é€æ•°æ®çš„æ ¼å¼ï¼Œå¦‚ application/json

response headers:

- Content-Type è¿”å›æ•°æ®çš„æ ¼å¼ï¼Œå¦‚ application/json
- Content-Length è¿”å›æ•°æ®çš„å¤§å°ï¼Œå¤šå°‘å­—èŠ‚
- Content-Encoding è¿”å›æ•°æ®çš„å‹ç¼©ç®—æ³•ï¼Œå¦‚ gzip
- Set-Cookie

#### ä»€ä¹ˆæ˜¯ restful api

- ä¼ ç»Ÿ API è®¾è®¡ï¼šæŠŠæ¯ä¸ª url å½“åšä¸€ä¸ªåŠŸèƒ½
- restful api è®¾è®¡ï¼šæŠŠæ¯ä¸ª url å½“åšä¸€ä¸ªå”¯ä¸€çš„èµ„æº

#### æè¿°ä¸€ä¸‹ http çš„ç¼“å­˜æœºåˆ¶

- æ­£å¸¸æ“ä½œï¼šåœ°å€æ è¾“å…¥ urlã€è·³è½¬é“¾æ¥ã€å‰è¿›åé€€ç­‰(å¼ºåˆ¶ç¼“å­˜æœ‰æ•ˆï¼Œåå•†ç¼“å­˜æœ‰æ•ˆ)
- æ‰‹åŠ¨åˆ·æ–°ï¼šF5ã€ç‚¹å‡»åˆ·æ–°æŒ‰é’®ã€ç‚¹å‡»èœå•åˆ·æ–°ï¼ˆå¼ºåˆ¶ç¼“å­˜å¤±æ•ˆï¼Œåå•†ç¼“å­˜æœ‰æ•ˆï¼‰
- å¼ºåˆ¶åˆ·æ–°ï¼šctrl + F5ï¼ˆå¼ºåˆ¶ç¼“å­˜å¤±æ•ˆï¼Œåå•†ç¼“å­˜å¤±æ•ˆï¼‰

å¼ºåˆ¶ç¼“å­˜ï¼š

Cache-Control: max-ageã€no-cacheã€no-store

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2025.png" alt="" width="100%" />

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2026.png" alt="" width="100%" />

åå•†ç¼“å­˜ï¼š

- æœåŠ¡ç«¯ç¼“å­˜ç­–ç•¥
- æœåŠ¡å™¨åˆ¤æ–­å®¢æˆ·ç«¯èµ„æºï¼Œæ˜¯å¦å’ŒæœåŠ¡ç«¯èµ„æºä¸€æ ·
- ä¸€è‡´åˆ™è¿”å› 304ï¼Œå¦åˆ™è¿”å› 200 å’Œæœ€æ–°çš„èµ„æº

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2027.png" alt="" width="100%" />

Last-Modified

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2028.png" alt="" width="100%" />

Etag

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2029.png" alt="" width="100%" />

### https

#### http ä¸ https çš„åŒºåˆ«

- http æ˜¯æ˜æ–‡ä¼ è¾“ï¼Œæ•æ„Ÿä¿¡æ¯å®¹æ˜“è¢«ä¸­é—´åŠ«æŒ
- https = http + åŠ å¯†ï¼ŒåŠ«æŒäº†ä¹Ÿæ— æ³•è§£å¯†

#### åŠ å¯†æ–¹å¼

- å¯¹ç§°åŠ å¯†ï¼šä¸€ä¸ª key åŒæ—¶è´Ÿè´£åŠ å¯†ã€è§£å¯†
- éå¯¹ç§°åŠ å¯†ï¼šä¸€å¯¹ keyï¼ŒA åŠ å¯†ä¹‹åï¼Œåªèƒ½ç”¨ B æ¥è§£å¯†
- https åŒæ—¶ç”¨åˆ°äº†è¿™ä¸¤ç§åŠ å¯†æ–¹å¼ï¼ˆå®‰å…¨ã€æˆæœ¬ã€é«˜æ•ˆï¼‰

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2030.png" alt="" width="100%" />

#### https è¯ä¹¦

- ä¸­é—´äººæ”»å‡»
- ä½¿ç”¨ç¬¬ä¸‰æ–¹è¯ä¹¦
- æµè§ˆå™¨æ ¡éªŒè¯ä¹¦

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2031.png" alt="" width="100%" />

## å¼€å‘ç¯å¢ƒ

### git

- git branch
- git status
- git diff
- git add .
- git commit -m â€œxxxâ€
- git checkout xxx
- git checkout -b xxx
- git push origin main
- git pull origin main
- git fetch
- git merge xxx
- git stash
- git stash pop

### è°ƒè¯•å·¥å…·

- chrome è°ƒè¯•å·¥å…·

### æŠ“åŒ…

- ç§»åŠ¨ç«¯ h5 é¡µï¼ŒæŸ¥çœ‹ç½‘ç»œè¯·æ±‚ï¼Œéœ€è¦ç”¨å·¥å…·æŠ“åŒ…
- windows ä¸€èˆ¬ç”¨ fiddler
- Mac OS ä¸€èˆ¬ç”¨ charles
- æ‰‹æœºå’Œç”µè„‘è¿åŒä¸€ä¸ªå±€åŸŸç½‘
- å°†æ‰‹æœºä»£ç†åˆ°ç”µè„‘ä¸Š
- æ‰‹æœºæµè§ˆç½‘é¡µï¼Œå³å¯æŠ“åŒ…
- æŸ¥çœ‹ç½‘ç»œè¯·æ±‚
- ç½‘å€åœ°ç†
- https

### webpack

```javascript
const path = require("path");
const HtmlWebpackPlugin = require("html-webpack-plugin");

module.exports = {
  mode: "development",
  entry: path.join(__dirname, "src", "index.js"),
  output: {
    filename: "bundle.js",
    path: path.join(__dirname, "dist"),
  },
  module: {
    rules: [
      {
        test: /\.js$/,
        loader: ["babel-loader"],
        include: path.join(__dirname, "src"),
        exclude: /node_modules/,
      },
    ],
  },
  plugins: [
    new HtmlWebpackPlugin({
      template: path.join(__dirname, "src", "index.html"),
      filename: "index.html",
    }),
  ],
  devServer: {
    port: 3000,
    contentBase: path.join(__dirname, "dist"),
  },
};
```

```javascript
const path = require("path");
const HtmlWebpackPlugin = require("html-webpack-plugin");

module.exports = {
  mode: "production",
  entry: path.join(__dirname, "src", "index.js"),
  output: {
    filename: "bundle.[contenthash].js",
    path: path.join(__dirname, "dist"),
  },
  module: {
    rules: [
      {
        test: /\.js$/,
        loader: ["babel-loader"],
        include: path.join(__dirname, "src"),
        exclude: /node_modules/,
      },
    ],
  },
  plugins: [
    new HtmlWebpackPlugin({
      template: path.join(__dirname, "src", "index.html"),
      filename: "index.html",
    }),
  ],
};
```

### babel

```json
{
  "presets": ["@babel/preset-env"]
}
```

### linux å¸¸ç”¨å‘½ä»¤

- ssh root@xxx.xxx.xx.xx
- lsã€ls -aã€ll
- mkdir xxx
- touch xxx
- vi xxx
- vim xxx
- rm -rf xxx
- cd xxx
- mv xxx xxx
- cp xxx xxx
- cat xxx
- grep xxx xxx

## è¿è¡Œç¯å¢ƒ

### é¡µé¢åŠ è½½è¿‡ç¨‹

#### ä»è¾“å…¥ url åˆ°æ¸²æŸ“å‡ºé¡µé¢çš„æ•´ä¸ªè¿‡ç¨‹

åŠ è½½è¿‡ç¨‹ï¼š

- DNS è§£æï¼šåŸŸå -> ip åœ°å€
- æµè§ˆå™¨æ ¹æ® ip åœ°å€å‘æœåŠ¡å™¨å‘é€ http è¯·æ±‚
- æœåŠ¡å™¨å¤„ç† http è¯·æ±‚ï¼Œè¿”å›ç»™æµè§ˆå™¨

æ¸²æŸ“è¿‡ç¨‹ï¼š

- æ ¹æ® HTML ä»£ç ç”Ÿæˆ DOM Tree
- æ ¹æ® CSS ä»£ç ç”Ÿæˆ CSSOM
- å°† DOM Tree å’Œ CSSOM æ•´åˆå½¢æˆ Render Tree
- æ ¹æ® Render Tree æ¸²æŸ“é¡µé¢
- é‡åˆ° \<script\> åˆ™æš‚åœæ¸²æŸ“ï¼Œä¼˜å…ˆåŠ è½½å¹¶æ‰§è¡Œ js ä»£ç ï¼Œå®Œæˆå†ç»§ç»­
- ç›´è‡³æŠŠ Render Tree æ¸²æŸ“å®Œæˆ

#### window.onload å’Œ DOMContentLoaded çš„åŒºåˆ«

- window.onload: èµ„æºå…¨éƒ¨åŠ è½½å®Œæ‰èƒ½æ‰§è¡Œï¼ŒåŒ…æ‹¬è§†é¢‘ã€å›¾ç‰‡ç­‰
- DOMContentLoaded: DOM æ¸²æŸ“å®Œå³å¯æ‰§è¡Œï¼Œæ­¤æ—¶å›¾ç‰‡ã€è§†é¢‘å¯èƒ½è¿˜æ²¡åŠ è½½å®Œ

### æ€§èƒ½ä¼˜åŒ–

#### æ€§èƒ½ä¼˜åŒ–åŸåˆ™

- å¤šä½¿ç”¨å†…å­˜ã€ç¼“å­˜æˆ–å…¶ä»–æ–¹æ³•
- å‡å°‘ CPU è®¡ç®—é‡ï¼Œå‡å°‘ç½‘ç»œåŠ è½½è€—æ—¶
- é€‚ç”¨äºæ‰€æœ‰ç¼–ç¨‹çš„æ€§èƒ½ä¼˜åŒ– - ç©ºé—´æ¢æ—¶é—´

#### ä»ä½•å…¥æ‰‹

- è®©åŠ è½½æ›´å¿«
- è®©æ¸²æŸ“æ›´å¿«

#### è®©åŠ è½½æ›´å¿«

- å‡å°‘èµ„æºä½“ç§¯ï¼šå‹ç¼©ä»£ç 
- å‡å°‘è®¿é—®æ¬¡æ•°ï¼šåˆå¹¶ä»£ç ã€SSRã€ç¼“å­˜
- ä½¿ç”¨æ›´å¿«çš„ç½‘ç»œï¼šCDN

#### è®©æ¸²æŸ“æ›´å¿«

- CSS æ”¾åœ¨ headï¼ŒJS æ”¾åœ¨ body æœ€ä¸‹é¢
- å°½æ—©å¼€å§‹æ‰§è¡Œ JSï¼Œç”¨ DOMContentLoaded è§¦å‘
- æ‡’åŠ è½½ï¼ˆå›¾ç‰‡æ‡’åŠ è½½ï¼Œä¸Šæ»‘åŠ è½½æ›´å¤šï¼‰
- å¯¹ DOM æŸ¥è¯¢è¿›è¡Œç¼“å­˜
- é¢‘ç¹ DOM æ“ä½œï¼Œåˆå¹¶åˆ°ä¸€èµ·æ’å…¥ DOM ç»“æ„
- èŠ‚æµ throttleã€é˜²æŠ– debounce

#### é˜²æŠ– debounce

- ç”¨æˆ·è¾“å…¥ç»“æŸæˆ–æš‚åœæ—¶ï¼Œæ‰ä¼šè§¦å‘ change äº‹ä»¶

```javascript
function debounce(fn, delay = 500) {
  let timer = null;
  return function () {
    if (timer) {
      clearTimeout(timer);
    }
    timer = setTimeout(() => {
      fn.apply(this, arguments);
      timer = null;
    }, delay);
  };
}
```

#### èŠ‚æµ throttle

- æ— è®ºæ‹–æ‹½é€Ÿåº¦å¤šå¿«ï¼Œéƒ½ä¼šæ¯éš” delay è§¦å‘ä¸€æ¬¡

```javascript
function throttle(fn, delay = 500) {
  let timer = null;
  return function () {
    if (timer) {
      return;
    }
    timer = setTimeout(() => {
      fn.apply(this, arguments);
      timer = null;
    }, delay);
  };
}
```

### å®‰å…¨

#### å¸¸è§çš„ web å‰ç«¯æ”»å‡»æ–¹å¼æœ‰å“ªäº›

xss è·¨ç«™è¯·æ±‚æ”»å‡»ï¼š

- ä¸€ä¸ªåšå®¢ç½‘ç«™ï¼Œæˆ‘å‘è¡¨ä¸€ç¯‡åšå®¢ï¼Œå…¶ä¸­åµŒå…¥ \<script\> è„šæœ¬
- è„šæœ¬å†…å®¹ï¼šè·å– cookieï¼ˆdocument.cookieï¼‰ï¼Œå‘é€åˆ°æˆ‘çš„æœåŠ¡å™¨
- å‘å¸ƒè¿™ç¯‡åšå®¢ï¼Œæœ‰äººæŸ¥çœ‹å®ƒï¼Œæˆ‘è½»æ¾æ”¶å‰²è®¿é—®è€…çš„ cookie

xss é¢„é˜²ï¼š

- æ›¿æ¢ç‰¹æ®Šç¬¦å·ï¼Œå¦‚ < å˜ä¸º &lt; > å˜ä¸º &gt;
- \<script\> å˜ä¸º &lt;script&gt;ï¼Œç›´æ¥æ˜¾ç¤ºï¼Œè€Œä¸ä¼šä½œä¸ºè„šæœ¬æ‰§è¡Œ
- å‰ç«¯è¦æ›¿æ¢ï¼Œåç«¯ä¹Ÿè¦æ›¿æ¢ï¼Œéƒ½åšæ€»ä¸ä¼šé”™

xsrf è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼š

- ä½ æ­£åœ¨è´­ç‰©ï¼Œçœ‹ä¸­äº†æŸä¸ªå•†å“ï¼Œå•†å“ id æ˜¯ 100
- ä»˜è´¹æ¥å£æ˜¯ xxx.com/pay?id=100ï¼Œæ²¡æœ‰ä»»ä½•éªŒè¯
- æˆ‘æ˜¯æ”»å‡»è€…ï¼Œçœ‹ä¸­äº†ä¸€ä¸ªå•†å“ï¼Œid æ˜¯ 200
- æˆ‘å‘ä½ å‘é€ä¸€å°é‚®ä»¶ï¼Œé‚®ä»¶æ ‡é¢˜å¾ˆå¸å¼•äºº
- é‚®ä»¶æ­£æ–‡éšè—ç€ <img src=xxx.com/pay?id=200>
- ä½ ä¸€æŸ¥çœ‹é‚®ä»¶ï¼Œå°±å¸®æˆ‘è´­ä¹°äº† id æ˜¯ 200 çš„å•†å“

xsrf é¢„é˜²ï¼š

- ä½¿ç”¨ post æ¥å£
- å¢åŠ éªŒè¯ï¼Œä¾‹å¦‚æŒ‡çº¹ã€çŸ­ä¿¡éªŒè¯ç ç­‰

## çœŸé¢˜æ¨¡æ‹Ÿ

### varã€letã€const åŒºåˆ«

- var æ˜¯ es5 è¯­æ³•ï¼Œlet const æ˜¯ es6 è¯­æ³•ï¼›var æœ‰å˜é‡æå‡
- var let æ˜¯å˜é‡ï¼Œå¯ä¿®æ”¹ï¼›const æ˜¯å¸¸é‡ï¼Œä¸å¯ä¿®æ”¹
- let const æœ‰å—çº§ä½œç”¨åŸŸï¼Œvar æ²¡æœ‰

### typeof èƒ½åˆ¤æ–­å“ªäº›ç±»å‹

- stringã€numberã€booleanã€undefinedã€symbol
- object (typeof null === 'object')
- function

### åˆ—ä¸¾å¼ºåˆ¶ç±»å‹è½¬æ¢å’Œéšå¼ç±»å‹è½¬æ¢

- å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼šparseIntã€parseFloatã€toString ç­‰
- éšå¼ç±»å‹è½¬æ¢ï¼šifã€é€»è¾‘è¿ç®—ã€==ã€+ æ‹¼æ¥å­—ç¬¦ä¸²

### **æ‰‹å†™æ·±åº¦æ¯”è¾ƒï¼Œæ¨¡æ‹Ÿ lodash isEqual**

```javascript
function isObject(obj) {
  return typeof obj === "object" && obj !== null;
}

function isEqual(obj1, obj2) {
  if (!isObject(obj1) || !isObject(obj2)) {
    // å€¼ç±»å‹ï¼ˆæ³¨æ„ï¼šå‚ä¸ equal çš„ä¸€èˆ¬ä¸ä¼šæ˜¯å‡½æ•°ï¼‰
    return obj1 === obj2;
  }

  if (obj1 === obj2) {
    return true;
  }

  // ä¸¤ä¸ªéƒ½æ˜¯å¯¹è±¡æˆ–æ•°ç»„ï¼Œè€Œä¸”ä¸ç›¸ç­‰
  // 1. å…ˆå–å‡º obj1 å’Œ obj2 çš„ keysï¼Œæ¯”è¾ƒä¸ªæ•°
  const obj1Keys = Object.keys(obj1);
  const obj2Keys = Object.keys(obj2);
  if (obj1Keys.length !== obj2Keys.length) {
    return false;
  }

  // 2. ä»¥ obj1 ä¸ºåŸºç¡€ï¼Œå’Œ obj2 ä¾æ¬¡é€’å½’æ¯”è¾ƒ
  for (let key in obj1) {
    // æ¯”è¾ƒå½“å‰ key çš„val
    const res = isEqual(obj1[key], obj2[key]);
    if (!res) {
      return false;
    }
  }
  // 3. å…¨ç›¸ç­‰
  return true;
}
```

### split() å’Œ join() çš„åŒºåˆ«

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2032.png" alt="" width="100%" />

### æ•°ç»„çš„ popã€pushã€shiftã€unshift åˆ†åˆ«æ˜¯ä»€ä¹ˆ

- åŠŸèƒ½æ˜¯ä»€ä¹ˆ
- è¿”å›å€¼æ˜¯ä»€ä¹ˆ
- æ˜¯å¦ä¼šå¯¹åŸæ•°ç»„é€ æˆå½±å“

```javascript
// const arr = [10, 20, 30, 40]

// // pop
// const popRes = arr.pop()
// console.log(popRes, arr)

// // shift
// const shiftRes = arr.shift()
// console.log(shiftRes, arr)

// // push
// const pushRes = arr.push(50) // è¿”å› length
// console.log(pushRes, arr)

// // unshift
// const unshiftRes = arr.unshift(5) // è¿”å› length
// console.log(unshiftRes, arr)
```

#### æ•°ç»„çš„ APIï¼Œæœ‰å“ªäº›æ˜¯çº¯å‡½æ•°

```javascript
// // çº¯å‡½æ•°ï¼š1. ä¸æ”¹å˜æºæ•°ç»„ï¼ˆæ²¡æœ‰å‰¯ä½œç”¨ï¼‰ï¼›2. è¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„
// const arr = [10, 20, 30, 40]

// // concat
// const arr1 = arr.concat([50, 60, 70])
// // map
// const arr2 = arr.map(num => num * 10)
// // filter
// const arr3 = arr.filter(num => num > 25)
// // slice
// const arr4 = arr.slice()
```

#### æ•°ç»„çš„ APIï¼Œæœ‰å“ªäº›æ˜¯éçº¯å‡½æ•°

```javascript
// // push pop shift unshift
// // forEach
// // some every
// // reduce
// splice
```

### æ•°ç»„ slice å’Œ splice åŒºåˆ«

- slice-åˆ‡ç‰‡ splice-å‰ªæ¥
- å‚æ•°å’Œè¿”å›å€¼
- æ˜¯å¦æ˜¯çº¯å‡½æ•°

```javascript
// const arr = [10, 20, 30, 40, 50]

// // slice çº¯å‡½æ•°
// const arr1 = arr.slice()
// const arr2 = arr.slice(1, 4) // startIndex endIndex
// const arr4 = arr.slice(-3) // ä»æœ€åå¼€å§‹æˆªå–
```

```javascript
var myFish = ["angel", "clown", "drum", "mandarin", "sturgeon"];
var removed = myFish.splice(3, 1); // ä»ç´¢å¼•3ä½ç½®å¼€å§‹åˆ é™¤1ä¸ªå…ƒç´ 

var myFish = ["angel", "clown", "mandarin", "sturgeon"];
var removed = myFish.splice(2, 0, "drum", "guitar"); // ä»ç´¢å¼•2ä½ç½®å¼€å§‹æ·»åŠ ä¸¤ä¸ªå…ƒç´ 
```

### [10, 20, 30].map(parseInt) è¿”å›ç»“æœæ˜¯ä»€ä¹ˆ

```javascript
[10, 20, 30].map((num, index) => {
  return parseInt(num, index);
});
```

ç­”æ¡ˆï¼š[10, NaN, NaN]

### ajax è¯·æ±‚ get å’Œ post çš„åŒºåˆ«

- get ä¸€èˆ¬ç”¨äºæŸ¥è¯¢æ“ä½œï¼Œpost ä¸€èˆ¬ç”¨äºç”¨æˆ·æäº¤æ“ä½œ
- get å‚æ•°æ‹¼æ¥åœ¨ url ä¸Šï¼Œpost æ”¾åœ¨è¯·æ±‚ä½“å†…
- post æ˜“äºé˜²æ­¢ xsrf

### å‡½æ•° call å’Œ apply çš„åŒºåˆ«

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2033.png" alt="" width="100%" />

### äº‹ä»¶ä»£ç†æ˜¯ä»€ä¹ˆ

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2034.png" alt="" width="100%" />

### é—­åŒ…æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç‰¹æ€§ï¼Ÿæœ‰ä»€ä¹ˆè´Ÿé¢å½±å“

- å›é¡¾ä½œç”¨åŸŸå’Œè‡ªç”±å˜é‡
- å›é¡¾é—­åŒ…åº”ç”¨åœºæ™¯ï¼šä½œä¸ºå‚æ•°è¢«ä¼ å…¥ï¼Œä½œä¸ºè¿”å›å€¼è¢«è¿”å›
- å›é¡¾ï¼šè‡ªç”±å˜é‡çš„æŸ¥æ‰¾ï¼Œè¦åœ¨å‡½æ•°å®šä¹‰çš„åœ°æ–¹ï¼ˆè€Œä¸æ˜¯æ‰§è¡Œçš„åœ°æ–¹ï¼‰
- å½±å“ï¼šå˜é‡ä¼šå¸¸é©»å†…å­˜ï¼Œå¾—ä¸åˆ°é‡Šæ”¾ï¼ˆä¸ä¸€å®šå¯¼è‡´å†…å­˜æ³„æ¼ï¼‰

### å¦‚ä½•é˜»æ­¢äº‹ä»¶å†’æ³¡å’Œé»˜è®¤è¡Œä¸º

- event.stopPropagation()
- event.preventDefault()

### æŸ¥æ‰¾ã€æ·»åŠ ã€åˆ é™¤ã€ç§»åŠ¨ DOM èŠ‚ç‚¹çš„æ–¹æ³•

- å›é¡¾ä¹‹å‰å†…å®¹

### å¦‚ä½•å‡å°‘ DOM æ“ä½œ

- ç¼“å­˜ DOM æŸ¥è¯¢ç»“æœ
- å¤šæ¬¡ DOM æ“ä½œåˆå¹¶åˆ°ä¸€æ¬¡æ’å…¥

### è§£æ jsonp çš„åŸç†ï¼Œä¸ºä½•å®ƒä¸æ˜¯çœŸæ­£çš„ ajax

- æµè§ˆå™¨çš„åŒæºç­–ç•¥(æœåŠ¡ç«¯æ²¡æœ‰åŒæºç­–ç•¥)å’Œè·¨åŸŸ
- å“ªäº› html æ ‡ç­¾èƒ½ç»•è¿‡è·¨åŸŸ
- jsonp çš„åŸç†

### window.load å’Œ DOMContentLoaded çš„åŒºåˆ«

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2035.png" alt="" width="100%" />

### == å’Œ === çš„ä¸åŒ

- == ä¼šå°è¯•ç±»å‹è½¬æ¢
- === ä¸¥æ ¼ç›¸ç­‰
- å“ªäº›åœºæ™¯æ‰ç”¨ == å¦‚ï¼šif (null == undefined)

### å‡½æ•°å£°æ˜å’Œå‡½æ•°è¡¨è¾¾å¼çš„åŒºåˆ«

- å‡½æ•°å£°æ˜ function fn() {...}
- å‡½æ•°è¡¨è¾¾å¼ const fn = function () {...}
- å‡½æ•°å£°æ˜ä¼šæœ‰å˜é‡æå‡ï¼Œå‡½æ•°è¡¨è¾¾å¼æ²¡æœ‰

### new Object() å’Œ Object.create()çš„åŒºåˆ«

- {} ç­‰åŒäº new Object()ï¼ŒåŸå‹æ˜¯ Object.prototype
- Object.create(null) æ²¡æœ‰åŸå‹
- Object.create({...}) å¯æŒ‡å®šåŸå‹

### å…³äº this çš„åœºæ™¯é¢˜

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2036.png" alt="" width="100%" />

ç­”æ¡ˆï¼š1 window

### å…³äºä½œç”¨åŸŸå’Œè‡ªç”±å˜é‡çš„åœºæ™¯é¢˜

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2037.png" alt="" width="100%" />

ç­”æ¡ˆï¼š4

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2038.png" alt="" width="100%" />

ç­”æ¡ˆï¼š100 10 10

### åˆ¤æ–­å­—ç¬¦ä¸²ä»¥å­—æ¯å¼€å¤´ï¼Œåé¢å­—æ¯æ•°å­—ä¸‹åˆ’çº¿ï¼Œé•¿åº¦ 6-30

ç­”æ¡ˆï¼š/^[a-zA-Z]\w{5, 29}$/ \w å­—æ¯æ•°å­—ä¸‹åˆ’çº¿ \. å­—ç¬¦.

```javascript
// é‚®æ”¿ç¼–ç 
/\d{6}/

// å°å†™è‹±æ–‡å­—æ¯
/^[a-z]+$/

// è‹±æ–‡å­—æ¯
/^[a-zA-Z]+$/

// æ—¥æœŸæ ¼å¼ 2019.12.1
/^\d{4}-\d{1,2}-\d{1,2}$/

// ç”¨æˆ·å
/^[a-zA-Z]\w{5, 17}$/

// ç®€å•çš„ IP åœ°å€åŒ¹é…
/\d+\.\d+\.\d+\.\d+/

```

### æ‰‹å†™å­—ç¬¦ä¸² trim æ–¹æ³•ï¼Œä¿è¯æµè§ˆå™¨å…¼å®¹æ€§

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2039.png" alt="" width="100%" />

### å¦‚ä½•è·å–å¤šä¸ªæ•°å­—ä¸­çš„æœ€å¤§å€¼

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2040.png" alt="" width="100%" />

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2041.png" alt="" width="100%" />

### å¦‚ä½•ç”¨ js å®ç°ç»§æ‰¿

- class ç»§æ‰¿
- prototype ç»§æ‰¿

### å¦‚ä½•æ•è· js ç¨‹åºä¸­çš„å¼‚å¸¸

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2042.png" alt="" width="100%" />

### ä»€ä¹ˆæ˜¯ JSON

- æ˜¯ä¸€ç§æ•°æ®æ ¼å¼ï¼Œæœ¬è´¨æ˜¯ä¸€æ®µå­—ç¬¦ä¸²
- å’Œ js å¯¹è±¡ç»“æ„ä¸€è‡´ï¼Œå¯¹ js è¯­è¨€æ›´å¥½
- JSON.parse JSON.stringify

### è·å–å½“å‰é¡µé¢çš„ url å‚æ•°

- ä¼ ç»Ÿæ–¹å¼ location.search
- æ–° APIï¼ŒURLSearchParams

```javascript
function query(name) {
  const search = location.search.substr(1); // ç±»ä¼¼ array.slice(1)
  // search: 'a=10&b=20&c=30'
  const reg = newRegExp(`(^|&)${name}=([^&]*)(&|$)`, "i");
  const res = search.match(reg);
  if (res === null) {
    return null;
  }
  return res[2];
}
```

### å°† url å‚æ•°è§£æä¸º JS å¯¹è±¡

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2043.png" alt="" width="100%" />

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2044.png" alt="" width="100%" />

### æ‰‹å†™æ•°ç»„ flaternï¼Œè€ƒè™‘å¤šå±‚çº§

```javascript
function flat(arr) {
  // éªŒè¯ arr ä¸­ï¼Œè¿˜æœ‰æ²¡æœ‰æ·±å±‚æ•°ç»„
  const isDeep = arr.some((item) => item instanceof Array);
  if (!isDeep) {
    return arr;
  }
  const res = Array.prototype.concat.apply([], arr);
  return flat(res);
}
```

### æ•°ç»„å»é‡

- ä¼ ç»Ÿæ–¹å¼ï¼Œéå†å…ƒç´ æŒ¨ä¸ªæ¯”è¾ƒã€å»é‡
- ä½¿ç”¨ Set

```javascript
function unique(arr) {
  const res = [];
  arr.forEach((item) => {
    if (res.indexOf(item) === -1) {
      res.push(item);
    }
  });
  return res;
}
```

```javascript
function unique(arr) {
  const set = newSet(arr);
  return [...set];
}
```

### æ‰‹å†™æ·±æ‹·è´

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2045.png" alt="" width="100%" />

### ä»‹ç»ä¸€ä¸‹ RAF requestAnimatioFrame

- è¦æƒ³åŠ¨ç”»æµç•…ã€‚æ›´æ–°é¢‘ç‡è¦ 60 å¸§/sï¼Œå³ 16.67ms æ›´æ–°ä¸€æ¬¡è§†å›¾
- setTimeout è¦æ‰‹åŠ¨æ§åˆ¶é¢‘ç‡ï¼ŒRFA æµè§ˆå™¨ä¼šè‡ªåŠ¨æ§åˆ¶
- åå°æ ‡ç­¾æˆ–éšè— iframe ä¸­ï¼ŒRFA ä¼šæš‚åœï¼Œè€Œ setTimeout ä¾ç„¶æ‰§è¡Œ

```javascript
// 3s æŠŠå®½åº¦ä» 100px å˜ä¸º 640px ï¼Œå³å¢åŠ  540px
// 60å¸§/s ï¼Œ3s 180 å¸§ ï¼Œæ¯æ¬¡å˜åŒ– 3px

const $div1 = $("#div1");
let curWidth = 100;
const maxWidth = 640;

// // setTimeout
// function animate() {
//     curWidth = curWidth + 3
//     $div1.css('width', curWidth)
//     if (curWidth < maxWidth) {
//         setTimeout(animate, 16.7) // è‡ªå·±æ§åˆ¶æ—¶é—´
//     }
// }
// animate()

// RAF
function animate() {
  curWidth = curWidth + 5;
  $div1.css("width", curWidth);
  if (curWidth < maxWidth) {
    window.requestAnimationFrame(animate); // æ—¶é—´ä¸ç”¨è‡ªå·±æ§åˆ¶
  }
}
animate();
```

### å‰ç«¯æ€§èƒ½å¦‚ä½•ä¼˜åŒ–ï¼Ÿä¸€èˆ¬ä»å‡ ä¸ªåœ°æ–¹è€ƒè™‘

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2046.png" alt="" width="100%" />

### Map å’Œ Set æœ‰åºå’Œæ— åº

æœ‰åºï¼šé¡ºåºï¼Œå¢åˆ æŸ¥æ”¹æ…¢ï¼ˆæ•°ç»„ï¼‰

æ— åºï¼šæ•£ä¹±ï¼Œå¢åˆ æŸ¥æ”¹å¿«ï¼ˆå¯¹è±¡ï¼‰

<img src="%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%A8%E5%AE%B6%E6%A1%B6%20e718b4b520794bdaab10ba78fcbfe89c/Untitled%2047.png" alt="" width="100%" />

### Map å’Œ Object çš„åŒºåˆ«

- API ä¸åŒï¼ŒMap å¯ä»¥ä»¥ä»»æ„ç±»å‹ä¸º key
- Map æ˜¯æœ‰åºç»“æ„ï¼ˆé‡è¦ï¼‰
- Map æ“ä½œåŒæ ·å¾ˆå¿«

### Set å’Œæ•°ç»„çš„åŒºåˆ«

- API ä¸åŒ
- Set å…ƒç´ ä¸èƒ½é‡å¤
- Set æ˜¯æ— åºç»“æ„ï¼Œæ“ä½œå¾ˆå¿«

### weakMap å’Œ weakSet

- å¼±å¼•ç”¨ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼
- weakMap åªèƒ½ç”¨å¯¹è±¡ä½œä¸º keyï¼ŒweakSet åªèƒ½ç”¨å¯¹è±¡ä½œä¸º value
- æ²¡æœ‰ forEach å’Œ sizeï¼Œåªèƒ½ç”¨ add delete has

### æ•°ç»„ reduce ç”¨æ³•

- æ±‚å’Œ

```javascript
constarr = [10, 20, 30, 40, 50];
constres = arr.reduce((sum, curVal) => sum + curVal, 0);
```

- è®¡æ•°

```javascript
constarr = [10, 20, 30, 40, 50, 10, 20, 30, 20];
constn = 30;
constcount = arr.reduce((count, val) => {
  return val === n ? count + 1 : count;
}, 0);
```

- è¾“å‡ºå­—ç¬¦ä¸²

```javascript
constarr = [
  { name: "å¼ ä¸‰", age: "20" },
  { name: "æå››", age: "21" },
  { name: "å°æ˜", age: "22" },
];
conststr = arr.reduce((s, item) => {
  return `${s}${item.name} - ${item.age}\n`;
}, "");
console.log(str);
```

## React

### åŸºæœ¬ä½¿ç”¨

#### JSX åŸºæœ¬ä½¿ç”¨

- å˜é‡ã€è¡¨è¾¾å¼
- classã€style
- å­å…ƒç´ å’Œç»„ä»¶

```javascript
render () {
    // // è·å–å˜é‡ æ’å€¼
    const pElem = <p>{this.state.name}</p>
    return pElem

    // // è¡¨è¾¾å¼
    const exprElem = <p>{this.state.flag ? 'yes' : 'no'}</p>
    return exprElem

    // // å­å…ƒç´ 
    const imgElem = <div>
        <p>æˆ‘çš„å¤´åƒ</p>
        <img src="xxxx.png"/>
        <img src={this.state.imgUrl}/>
    </div>
    return imgElem

    // // class
    const classElem = <p className="title">è®¾ç½® css class</p>
    return classElem

    // // style
    const styleData = { fontSize: '30px',  color: 'blue' }
    const styleElem = <p style={styleData}>è®¾ç½® style</p>
    // å†…è”å†™æ³•ï¼Œæ³¨æ„ {{ å’Œ }}
    // const styleElem = <p style={{ fontSize: '30px',  color: 'blue' }}>è®¾ç½® style</p>
    return styleElem

    // // åŸç”Ÿ html
    const rawHtml = '<span>å¯Œæ–‡æœ¬å†…å®¹<i>æ–œä½“</i><b>åŠ ç²—</b></span>'
    const rawHtmlData = {
        __html: rawHtml // æ³¨æ„ï¼Œå¿…é¡»æ˜¯è¿™ç§æ ¼å¼
    }
    const rawHtmlElem = <div>
        <p dangerouslySetInnerHTML={rawHtmlData}></p>
        <p>{rawHtml}</p>
    </div>
    return rawHtmlElem

    // // åŠ è½½ç»„ä»¶
    const componentElem = <div>
        <p>JSX ä¸­åŠ è½½ä¸€ä¸ªç»„ä»¶</p>
        <hr/>
        <List/>
    </div>
    return componentElem
}

```

#### æ¡ä»¶åˆ¤æ–­å’Œæ¸²æŸ“åˆ—è¡¨

##### æ¡ä»¶åˆ¤æ–­

- if else
- ä¸‰å…ƒè¡¨è¾¾å¼
- é€»è¾‘è¿ç®—ç¬¦ && ||

```javascript
render() {
    const blackBtn = <button className="btn-black">black btn</button>
    const whiteBtn = <button className="btn-white">white btn</button>

    // // if else
    if (this.state.theme === 'black') {
        return blackBtn
    } else {
        return whiteBtn
    }

    // // ä¸‰å…ƒè¿ç®—ç¬¦
    return <div>
        { this.state.theme === 'black' ? blackBtn : whiteBtn }
    </div>

    // &&
    return <div>
        { this.state.theme === 'black' && blackBtn }
    </div>
}

```

##### æ¸²æŸ“åˆ—è¡¨

- map
- key

```javascript
render() {
    return <ul>
        { /* vue v-for */
            this.state.list.map(
                (item, index) => {
                    // è¿™é‡Œçš„ key å’Œ Vue çš„ key ç±»ä¼¼ï¼Œå¿…å¡«ï¼Œä¸èƒ½æ˜¯ index æˆ– random
                    return <li key={item.id}>
                        index {index}; id {item.id}; title {item.title}
                    </li>
                }
            )
        }
    </ul>
}

```

#### äº‹ä»¶

- bind this
- å…³äº event å‚æ•°
- ä¼ é€’è‡ªå®šä¹‰å‚æ•°

```javascript
this.clickHandler1 = this.clickHandler1.bind(this)

clickHandler1() {
    // console.log('this....', this) // this é»˜è®¤æ˜¯ undefined
    this.setState({
        name: 'lisi'
    })
}

// // this - ä½¿ç”¨ bind
return <p onClick={this.clickHandler1}>
   {this.state.name}
</p>

```

```javascript
// é™æ€æ–¹æ³•ï¼Œthis æŒ‡å‘å½“å‰å®ä¾‹
clickHandler2 = () => {
  this.setState({
    name: "lisi",
  });
};

return <p onClick={this.clickHandler2}>clickHandler2 {this.state.name}</p>;
```

```javascript
clickHandler3 = (event) => {
  event.preventDefault(); // é˜»æ­¢é»˜è®¤è¡Œä¸º
  event.stopPropagation(); // é˜»æ­¢å†’æ³¡
  console.log("target", event.target); // æŒ‡å‘å½“å‰å…ƒç´ ï¼Œå³å½“å‰å…ƒç´ è§¦å‘
  console.log("current target", event.currentTarget); // æŒ‡å‘å½“å‰å…ƒç´ ï¼Œå‡è±¡ï¼ï¼ï¼

  // æ³¨æ„ï¼Œevent å…¶å®æ˜¯ React å°è£…çš„ã€‚å¯ä»¥çœ‹ __proto__.constructor æ˜¯ SyntheticEvent ç»„åˆäº‹ä»¶
  console.log("event", event); // ä¸æ˜¯åŸç”Ÿçš„ Event ï¼ŒåŸç”Ÿçš„æ˜¯ MouseEvent
  console.log("event.__proto__.constructor", event.__proto__.constructor);

  // åŸç”Ÿ event å¦‚ä¸‹ã€‚å…¶ __proto__.constructor æ˜¯ MouseEvent
  console.log("nativeEvent", event.nativeEvent);
  console.log("nativeEvent target", event.nativeEvent.target); // æŒ‡å‘å½“å‰å…ƒç´ ï¼Œå³å½“å‰å…ƒç´ è§¦å‘
  console.log("nativeEvent current target", event.nativeEvent.currentTarget); // æŒ‡å‘ document ï¼ï¼ï¼ï¼ˆç»‘å®šäº‹ä»¶çš„å…ƒç´ ï¼‰

  // 1. event æ˜¯ SyntheticEvent ï¼Œæ¨¡æ‹Ÿ DOM äº‹ä»¶æ‰€æœ‰èƒ½åŠ›
  // 2. event.nativeEvent æ˜¯åŸç”Ÿäº‹ä»¶å¯¹è±¡
  // 3. æ‰€æœ‰çš„äº‹ä»¶ï¼Œéƒ½è¢«æŒ‚è½½åˆ° document ä¸Š(React17 åç»‘å®šåˆ° root ç»„ä»¶ï¼Œæœ‰åˆ©äºå¤šä¸ªç‰ˆæœ¬å…±å­˜)
  // 4. å’Œ DOM äº‹ä»¶ä¸ä¸€æ ·ï¼Œå’Œ Vue äº‹ä»¶ä¹Ÿä¸ä¸€æ ·
};

// // event
// return <a href="https://imooc.com/" onClick={this.clickHandler3}>
//     click me
// </a>
```

<img src="%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB%2045ad321291ec41f4acbef82cb460d3c4/image.png" alt="" width="100%" />

```javascript
// ä¼ é€’å‚æ•° - ç”¨ bind(this, a, b)
return <ul>{this.state.list.map((item, index) => {
    return <li key={item.id} onClick={this.clickHandler4.bind(this, item.id, item.title)}>
        index {index}; title {item.title}
    </li>
})}</ul>

// ä¼ é€’å‚æ•°
clickHandler4(id, title, event) {
  console.log(id, title)
  console.log('event', event) // æœ€åè¿½åŠ ä¸€ä¸ªå‚æ•°ï¼Œå³å¯æ¥æ”¶ event
}

```

#### è¡¨å•

- å—æ§ç»„ä»¶ï¼ˆstate å’Œ value ç»‘å®šï¼ŒonChange äº‹ä»¶ï¼‰
- éå—æ§ç»„ä»¶
- onChange äº‹ä»¶
- input textarea select ç”¨ value
- checkbox radio ç”¨ checked

```javascript
render() {
    // // å—æ§ç»„ä»¶ï¼ˆéå—æ§ç»„ä»¶ï¼Œåé¢å†è®²ï¼‰
    return <div>
        <p>{this.state.name}</p>
        <label htmlFor="inputName">å§“åï¼š</label> {/* ç”¨ htmlFor ä»£æ›¿ for */}
        <input id="inputName" value={this.state.name} onChange={this.onInputChange}/>
    </div>

    // textarea - ä½¿ç”¨ value
    return <div>
        <textarea value={this.state.info} onChange={this.onTextareaChange}/>
        <p>{this.state.info}</p>
    </div>

    // // select - ä½¿ç”¨ value
    return <div>
        <select value={this.state.city} onChange={this.onSelectChange}>
            <option value="beijing">åŒ—äº¬</option>
            <option value="shanghai">ä¸Šæµ·</option>
            <option value="shenzhen">æ·±åœ³</option>
        </select>
        <p>{this.state.city}</p>
    </div>

    // // checkbox
    return <div>
        <input type="checkbox" checked={this.state.flag} onChange={this.onCheckboxChange}/>
        <p>{this.state.flag.toString()}</p>
    </div>

    // // radio
    return <div>
        male <input type="radio" name="gender" value="male" checked={this.state.gender === 'male'} onChange={this.onRadioChange}/>
        female <input type="radio" name="gender" value="female" checked={this.state.gender === 'female'} onChange={this.onRadioChange}/>
        <p>{this.state.gender}</p>
    </div>

    // éå—æ§ç»„ä»¶ - åé¢å†è®²
}
onInputChange = (e) => {
    this.setState({
        name: e.target.value
    })
}
onTextareaChange = (e) => {
    this.setState({
        info: e.target.value
    })
}
onSelectChange = (e) => {
    this.setState({
        city: e.target.value
    })
}
onCheckboxChange = () => {
    this.setState({
        flag: !this.state.flag
    })
}
onRadioChange = (e) => {
    this.setState({
        gender: e.target.value
    })
}

```

#### ç»„ä»¶ä½¿ç”¨

- props ä¼ é€’æ•°æ®
- props ä¼ é€’å‡½æ•°
- props ç±»å‹æ£€æŸ¥

```javascript
import PropTypes from 'prop-types'

class Input extendsReact.Component {
    constructor(props) {
        super(props)
        this.state = {
            title: ''
        }
    }
    render() {
        return <div>
            <input value={this.state.title} onChange={this.onTitleChange}/>
            <button onClick={this.onSubmit}>æäº¤</button>
        </div>
    }
    onTitleChange = (e) => {
        this.setState({
            title: e.target.value
        })
    }
    onSubmit = () => {
        const { submitTitle } = this.props
        submitTitle(this.state.title) // 'abc'

        this.setState({
            title: ''
        })
    }
}
// props ç±»å‹æ£€æŸ¥
Input.propTypes = {
    submitTitle: PropTypes.func.isRequired
}

class List extendsReact.Component {
    constructor(props) {
        super(props)
    }
    render() {
        const { list } = this.props

        return <ul>{list.map((item, index) => {
            return <li key={item.id}>
                <span>{item.title}</span>
            </li>
        })}</ul>
    }
}
// props ç±»å‹æ£€æŸ¥
List.propTypes = {
    list: PropTypes.arrayOf(PropTypes.object).isRequired
}

```

#### setState

- ä¸å¯å˜å€¼ï¼ˆä¸èƒ½ç›´æ¥ä¿®æ”¹ stateï¼‰
- å¯èƒ½æ˜¯å¼‚æ­¥æ›´æ–°
- å¯èƒ½ä¼šè¢«åˆå¹¶ï¼ˆæ‰¹å¤„ç†ï¼‰

##### ä¸å¯å˜å€¼

```javascript
// // ä¸è¦ç›´æ¥ä¿®æ”¹ state ï¼Œä½¿ç”¨ä¸å¯å˜å€¼ ----------------------------
// // this.state.count++ // é”™è¯¯
// this.setState({
//     count: this.state.count + 1 // SCU
// })
// æ“ä½œæ•°ç»„ã€å¯¹è±¡çš„çš„å¸¸ç”¨å½¢å¼

// // ä¸å¯å˜å€¼ï¼ˆå‡½æ•°å¼ç¼–ç¨‹ï¼Œçº¯å‡½æ•°ï¼‰ - æ•°ç»„
// const list5Copy = this.state.list5.slice()
// this.setState({
//     list1: this.state.list1.concat(100), // è¿½åŠ 
//     list2: [...this.state.list2, 100], // è¿½åŠ 
//     list3: this.state.list3.slice(0, 3), // æˆªå–
//     list4: this.state.list4.filter(item => item > 100), // ç­›é€‰
//     list5: list5Copy // å…¶ä»–æ“ä½œ
// })
// // æ³¨æ„ï¼Œä¸èƒ½ç›´æ¥å¯¹ this.state.list è¿›è¡Œ push pop splice ç­‰ï¼Œè¿™æ ·è¿åä¸å¯å˜å€¼

// // ä¸å¯å˜å€¼ï¼ˆæµ…æ‹·è´ï¼‰ - å¯¹è±¡
// this.setState({
//     obj1: Object.assign({}, this.state.obj1, {a: 100}),
//     obj2: {...this.state.obj2, a: 100}
// })
// // æ³¨æ„ï¼Œä¸èƒ½ç›´æ¥å¯¹ this.state.obj è¿›è¡Œå±æ€§è®¾ç½®ï¼Œè¿™æ ·è¿åä¸å¯å˜å€¼
```

##### å¯èƒ½æ˜¯å¼‚æ­¥æ›´æ–°

```javascript
// // ç›´æ¥ä½¿ç”¨æ˜¯å¼‚æ­¥
this.setState({
    count: this.state.count + 1
}, () => {
    // è”æƒ³ Vue $nextTick - DOM
    console.log('count by callback', this.state.count) // å›è°ƒå‡½æ•°ä¸­å¯ä»¥æ‹¿åˆ°æœ€æ–°çš„ state
})
console.log('count', this.state.count) // å¼‚æ­¥çš„ï¼Œæ‹¿ä¸åˆ°æœ€æ–°å€¼

// // setTimeout ä¸­ setState æ˜¯åŒæ­¥çš„
setTimeout(() => {
    this.setState({
        count: this.state.count + 1
    })
    console.log('count in setTimeout', this.state.count)
}, 0)

// // è‡ªå·±å®šä¹‰çš„ DOM äº‹ä»¶ï¼ŒsetState æ˜¯åŒæ­¥çš„, åœ¨ componentDidMount ä¸­
bodyClickHandler = () => {
    this.setState({
        count: this.state.count + 1
    })
    console.log('count in body event', this.state.count)
}
componentDidMount() {
    // è‡ªå·±å®šä¹‰çš„ DOM äº‹ä»¶ï¼ŒsetState æ˜¯åŒæ­¥çš„
    document.body.addEventListener('click', this.bodyClickHandler)
}
componentWillUnmount() {
    // åŠæ—¶é”€æ¯è‡ªå®šä¹‰ DOM äº‹ä»¶
    document.body.removeEventListener('click', this.bodyClickHandler)
    // clearTimeout
}

```

##### å¯èƒ½ä¼šè¢«åˆå¹¶

```javascript
// // ä¼ å…¥å¯¹è±¡ï¼Œä¼šè¢«åˆå¹¶ï¼ˆç±»ä¼¼ Object.assign ï¼‰ã€‚æ‰§è¡Œç»“æœåªæ‰§è¡Œä¸€æ¬¡ +1
this.setState({
  count: this.state.count + 1,
});
this.setState({
  count: this.state.count + 1,
});
this.setState({
  count: this.state.count + 1,
});

// ä¼ å…¥å‡½æ•°ï¼Œä¸ä¼šè¢«åˆå¹¶ã€‚æ‰§è¡Œç»“æœæ˜¯ +3
this.setState((prevState, props) => {
  return {
    count: prevState.count + 1,
  };
});
this.setState((prevState, props) => {
  return {
    count: prevState.count + 1,
  };
});
this.setState((prevState, props) => {
  return {
    count: prevState.count + 1,
  };
});
```

##### React <= 17 setState

- React ç»„ä»¶äº‹ä»¶ï¼šå¼‚æ­¥æ›´æ–° + åˆå¹¶ stateï¼ˆæ‰¹å¤„ç†ï¼‰
- DOM äº‹ä»¶ï¼ŒsetTimeoutï¼šåŒæ­¥æ›´æ–°ï¼Œä¸åˆå¹¶ state

##### React 18 setState

- React ç»„ä»¶äº‹ä»¶ï¼šå¼‚æ­¥æ›´æ–° + åˆå¹¶ state
- DOM äº‹ä»¶ï¼ŒsetTimeoutï¼šå¼‚æ­¥æ›´æ–° + åˆå¹¶ state
- Automatic Batching è‡ªåŠ¨æ‰¹å¤„ç†

#### ç”Ÿå‘½å‘¨æœŸ

- å•ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ
- çˆ¶å­ç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼Œå’Œ Vue çš„ä¸€æ ·

<img src="%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB%2045ad321291ec41f4acbef82cb460d3c4/image%201.png" alt="" width="100%" />

### é«˜çº§ç‰¹æ€§

#### å‡½æ•°ç»„ä»¶

- çº¯å‡½æ•°ç»„ä»¶ï¼Œè¾“å…¥ propsï¼Œè¾“å‡º JSX
- æ²¡æœ‰å®ä¾‹ï¼Œæ²¡æœ‰ç”Ÿå‘½å‘¨æœŸï¼Œæ²¡æœ‰ state
- ä¸èƒ½æ‰©å±•å…¶å®ƒæ–¹æ³•

<img src="%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB%2045ad321291ec41f4acbef82cb460d3c4/image%202.png" alt="" width="100%" />

#### éå—æ§ç»„ä»¶

- ref
- defaultValueã€defaultChecked
- æ‰‹åŠ¨æ“ä½œ DOM å…ƒç´ 

##### é€‚ç”¨åœºæ™¯

- å¿…é¡»æ‰‹åŠ¨æ“ä½œ DOM å…ƒç´ ï¼ŒsetState å®ç°ä¸äº†
- æ–‡ä»¶ä¸Šä¼  \<input type="file"\>
- æŸäº›å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œéœ€è¦ä¼ å…¥ DOM å…ƒç´ 

##### å—æ§ç»„ä»¶ vs éå—æ§ç»„ä»¶

- ä¼˜å…ˆä½¿ç”¨å—æ§ç»„ä»¶ï¼Œç¬¦åˆ React è®¾è®¡åŸåˆ™
- å¿…é¡»æ“ä½œ DOMï¼Œåˆ™ä½¿ç”¨éå—æ§ç»„ä»¶

```javascript
constructor(props) {
    super(props)
    this.state = {
        name: 'oweqian',
        flag: true,
    }
    this.nameInputRef = React.createRef() // åˆ›å»º ref
}

render() {
    // input defaultValue
    return <div>
        {/* ä½¿ç”¨ defaultValue è€Œä¸æ˜¯ value ï¼Œä½¿ç”¨ ref */}
        <input defaultValue={this.state.name} ref={this.nameInputRef}/>
        {/* state å¹¶ä¸ä¼šéšç€æ”¹å˜ */}
        <span>state.name: {this.state.name}</span>
        <br/>
        <button onClick={this.alertName}>alert name</button>
    </div>
}

alertName = () => {
    const elem = this.nameInputRef.current // é€šè¿‡ ref è·å– DOM èŠ‚ç‚¹
    alert(elem.value) // ä¸æ˜¯ this.state.name
}

```

#### React Portals

- ç»„ä»¶é»˜è®¤æŒ‰ç…§æ—¢å®šå±‚æ¬¡åµŒå¥—æ¸²æŸ“
- å¦‚ä½•è®©ç»„ä»¶æ¸²æŸ“åˆ°çˆ¶ç»„ä»¶ä»¥å¤–ï¼Ÿ

##### é€‚ç”¨åœºæ™¯

- å¯¹è¯æ¡† / æ¨¡æ€æ¡†
- overflow: hidden
- fixed éœ€è¦æ”¾åœ¨ body ç¬¬ä¸€å±‚çº§
- çˆ¶ç»„ä»¶ z-index å€¼å¤ªå°

```javascript
import React from 'react'
import ReactDOM from 'react-dom'

render() {
    // ä½¿ç”¨ Portals æ¸²æŸ“åˆ° body ä¸Šã€‚
    // fixed å…ƒç´ è¦æ”¾åœ¨ body ä¸Šï¼Œæœ‰æ›´å¥½çš„æµè§ˆå™¨å…¼å®¹æ€§ã€‚
    return ReactDOM.createPortal(<div className="modal">{this.props.children}</div>, document.body)
}
```

#### React Context

- å…¬å…±ä¿¡æ¯ï¼ˆè¯­è¨€ã€ä¸»é¢˜ï¼‰å¦‚ä½•ä¼ é€’ç»™æ¯ä¸ªç»„ä»¶ï¼Ÿ
- ç”¨ props å¤ªç¹ç
- ç”¨ redux å°é¢˜å¤§åš

```javascript
import React from 'react'

// åˆ›å»º Context å¡«å…¥é»˜è®¤å€¼ï¼ˆä»»ä½•ä¸€ä¸ª js å˜é‡ï¼‰
const ThemeContext = React.createContext('light')

// åº•å±‚ç»„ä»¶ - å‡½æ•°æ˜¯ç»„ä»¶
function ThemeLink (props) {
    // å‡½æ•°å¼ç»„ä»¶å¯ä»¥ä½¿ç”¨ Consumerï¼Œè¿”å›å‡½æ•°ä¼ å‚value
    return <ThemeContext.Consumer>
        { value => <p>link's theme is {value}</p> }
    </ThemeContext.Consumer>
}

// åº•å±‚ç»„ä»¶ - class ç»„ä»¶
class ThemedButton extendsReact.Component {
    // æŒ‡å®š contextType è¯»å–å½“å‰çš„ theme contextã€‚
    // static contextType = ThemeContext // ä¹Ÿå¯ä»¥ç”¨ ThemedButton.contextType = ThemeContext
    render() {
        const theme = this.context // React ä¼šå¾€ä¸Šæ‰¾åˆ°æœ€è¿‘çš„ theme Providerï¼Œç„¶åä½¿ç”¨å®ƒçš„å€¼ã€‚
        return <div>
            <p>button's theme is {theme}</p>
        </div>
    }
}
ThemedButton.contextType = ThemeContext // æŒ‡å®š contextType è¯»å–å½“å‰çš„ theme contextã€‚

// ä¸­é—´çš„ç»„ä»¶å†ä¹Ÿä¸å¿…æŒ‡æ˜å¾€ä¸‹ä¼ é€’ theme äº†ã€‚
function Toolbar(props) {
    return (
        <div>
            <ThemedButton />
            <ThemeLink />
        </div>
    )
}

class App extendsReact.Component {
    constructor(props) {
        super(props)
        this.state = {
            theme: 'light'
        }
    }
    render() {
        return <ThemeContext.Provider value={this.state.theme}>
            <Toolbar />
            <hr/>
            <button onClick={this.changeTheme}>change theme</button>
        </ThemeContext.Provider>
    }
    changeTheme = () => {
        this.setState({
            theme: this.state.theme === 'light' ? 'dark' : 'light'
        })
    }
}

export default App

```

#### å¼‚æ­¥ç»„ä»¶

- import
- React.lazy
- React.Suspense

```javascript
import React from 'react'

const ContextDemo = React.lazy(() => import('./ContextDemo'))

class App extendsReact.Component {
    constructor(props) {
        super(props)
    }
    render() {
        return <div>
            <p>å¼•å…¥ä¸€ä¸ªåŠ¨æ€ç»„ä»¶</p>
            <hr />
            <React.Suspense fallback={<div>Loading...</div>}>
                <ContextDemo/>
            </React.Suspense>
        </div>

        // 1. å¼ºåˆ¶åˆ·æ–°ï¼Œå¯çœ‹åˆ° loading ï¼ˆçœ‹ä¸åˆ°å°±é™åˆ¶ä¸€ä¸‹ chrome ç½‘é€Ÿï¼‰
        // 2. çœ‹ network çš„ js åŠ è½½
    }
}

export default App

```

#### æ€§èƒ½ä¼˜åŒ–

- shouldComponentUpdate(ç®€ç§° SCU)
- PureComponent å’Œ React.memo
- ä¸å¯å˜å€¼ immutable.js

##### SCU åŸºæœ¬ç”¨æ³•

<img src="%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB%2045ad321291ec41f4acbef82cb460d3c4/image%203.png" alt="" width="100%" />

##### SCU é»˜è®¤è¿”å›ä»€ä¹ˆ

React é»˜è®¤çˆ¶ç»„ä»¶æœ‰æ›´æ–°ï¼Œå­ç»„ä»¶åˆ™æ— æ¡ä»¶ä¹Ÿæ›´æ–°ï¼ŒSCU é»˜è®¤è¿”å› true(å³å¯ä»¥æ¸²æŸ“)

æ€§èƒ½ä¼˜åŒ–å¯¹ React æ›´åŠ é‡è¦!!!

SCU ä¸€å®šè¦æ¯æ¬¡éƒ½ç”¨å—ï¼Ÿ -- éœ€è¦çš„æ—¶å€™æ‰ä¼˜åŒ–

##### SCU ä¸€å®šè¦é…åˆ state ä¸å¯å˜å€¼

<img src="%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB%2045ad321291ec41f4acbef82cb460d3c4/image%204.png" alt="" width="100%" />

æ³¨ï¼šé…åˆ state ä¸å¯å˜å€¼éƒ¨åˆ†ï¼ˆå¾ˆé‡è¦ï¼ï¼ï¼ï¼‰

##### PureComponent å’Œ React.memo

- PureComponentï¼ˆé€‚ç”¨äºç±»ç»„ä»¶ï¼‰ï¼Œå®ç°äº†æµ…æ¯”è¾ƒ
- React.memoï¼Œå‡½æ•°ç»„ä»¶ä¸­çš„ PureComponent
- æµ…æ¯”è¾ƒå·²é€‚ç”¨å¤§éƒ¨åˆ†æƒ…å†µï¼ˆå°½é‡ä¸è¦åšæ·±åº¦æ¯”è¾ƒï¼‰

##### immutable.js

- å½»åº•æ‹¥æŠ± "ä¸å¯å˜å€¼"
- åŸºäºå…±äº«æ•°æ®ï¼ˆä¸æ˜¯æ·±æ‹·è´ï¼‰ï¼Œé€Ÿåº¦å¥½
- æœ‰ä¸€å®šå­¦ä¹ å’Œè¿ç§»æˆæœ¬ï¼Œè°¨æ…ä½¿ç”¨

<img src="%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB%2045ad321291ec41f4acbef82cb460d3c4/image%205.png" alt="" width="100%" />

#### å…¬å…±é€»è¾‘æŠ½ç¦»

- é«˜é˜¶ç»„ä»¶ HOC
- Render Props

##### HOC

<img src="%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB%2045ad321291ec41f4acbef82cb460d3c4/image%206.png" alt="" width="100%" />

```javascript
import React from 'react'

// é«˜é˜¶ç»„ä»¶
const withMouse = (Component) => {
    class withMouseComponent extendsReact.Component {
        constructor(props) {
            super(props)
            this.state = { x: 0, y: 0 }
        }

        handleMouseMove = (event) => {
            this.setState({
                x: event.clientX,
                y: event.clientY
            })
        }

        render() {
            return (
                <div style={{ height: '500px' }} onMouseMove={this.handleMouseMove}>
                    {/* 1. é€ä¼ æ‰€æœ‰ props 2. å¢åŠ  mouse å±æ€§ */}
                    <Component {...this.props} mouse={this.state}/>
                </div>
            )
        }
    }
    return withMouseComponent
}

const App = (props) => {
    const a = props.a
    const { x, y } = props.mouse // æ¥æ”¶ mouse å±æ€§
    return (
        <div style={{ height: '500px' }}>
            <h1>The mouse position is ({x}, {y})</h1>
            <p>{a}</p>
        </div>
    )
}

export default withMouse(App) // è¿”å›é«˜é˜¶å‡½æ•°

```

##### Render Props

<img src="%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB%2045ad321291ec41f4acbef82cb460d3c4/image%207.png" alt="" width="100%" />

##### HOC vs Render Props

- HOCï¼šæ¨¡å¼ç®€å•ï¼Œä½†ä¼šå¢åŠ ç»„ä»¶å±‚çº§
- Render Propsï¼šä»£ç ç®€ä»‹ï¼Œå­¦ä¹ æˆæœ¬è¾ƒé«˜
- æŒ‰éœ€ä½¿ç”¨

### Redux

- åŸºæœ¬æ¦‚å¿µ
- å•å‘æ•°æ®æµ
- React-Redux
- å¼‚æ­¥ action
- ä¸­é—´ä»¶

#### åŸºæœ¬æ¦‚å¿µ

- store state
- action
- reducer

#### å•å‘æ•°æ®æµ

- dispatch action
- reducer -> new State
- subscribe è§¦å‘é€šçŸ¥(è§†å›¾æ›´æ–°)

<img src="%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB%2045ad321291ec41f4acbef82cb460d3c4/image%208.png" alt="" width="100%" />

#### React-Redux

- <Provider> connect
- mapStateToProps mapDispatchToProps

#### å¼‚æ­¥ action

<img src="%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB%2045ad321291ec41f4acbef82cb460d3c4/image%209.png" alt="" width="100%" />

<img src="%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB%2045ad321291ec41f4acbef82cb460d3c4/image%2010.png" alt="" width="100%" />

#### ä¸­é—´ä»¶åŸç†

å¯¹ dispatch åšæ”¹é€ ã€‚

<img src="%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB%2045ad321291ec41f4acbef82cb460d3c4/image%2011.png" alt="" width="100%" />

<img src="%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB%2045ad321291ec41f4acbef82cb460d3c4/image%2012.png" alt="" width="100%" />

##### ä¸­é—´ä»¶ logger å®ç°

<img src="%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB%2045ad321291ec41f4acbef82cb460d3c4/image%2013.png" alt="" width="100%" />

### React-Router

- hash æ¨¡å¼
- h5 history æ¨¡å¼
- history æ¨¡å¼éœ€è¦ server ç«¯æ”¯æŒ

### React Hooks

#### class ç»„ä»¶çš„é—®é¢˜

- å¤§å‹ç»„ä»¶éš¾ä»¥æ‹†åˆ†å’Œé‡æ„ï¼Œå¾ˆéš¾æµ‹è¯•
- ç›¸åŒä¸šåŠ¡é€»è¾‘ï¼Œåˆ†æ•£åˆ°å„ä¸ªæ–¹æ³•ä¸­ï¼Œé€»è¾‘æ··ä¹±
- å¤ç”¨é€»è¾‘å˜çš„å¤æ‚ï¼Œå¦‚ HOCã€Render Props

#### React ç»„ä»¶æ›´æ˜“ç”¨å‡½æ•°è¡¨è¾¾

- React æå€¡å‡½æ•°å¼ç¼–ç¨‹ï¼Œview = fn (props)
- å‡½æ•°ç»„ä»¶æ›´çµæ´»ï¼Œæ›´æ˜“æ‹†åˆ†ï¼Œæ›´æ˜“æµ‹è¯•
- ä½†å‡½æ•°ç»„ä»¶å¤ªç®€å•ï¼Œéœ€è¦å¢å¼ºèƒ½åŠ› - Hooks

#### å‘½åè§„èŒƒ

- è§„å®šæ‰€æœ‰çš„ Hooks éƒ½ä»¥ use å¼€å¤´ï¼Œå¦‚ useXxx
- è‡ªå®šä¹‰ Hooks ä¹Ÿè¦ä»¥ use å¼€å¤´
- é Hooks çš„åœ°æ–¹ï¼Œå°½é‡ä¸è¦ä½¿ç”¨ useXxx å†™æ³•

#### useState

- useState(0) ä¼ å…¥åˆå§‹å€¼ï¼Œè¿”å›æ•°ç»„ [state, setState]
- é€šè¿‡ state è·å–å€¼
- é€šè¿‡ setState(1) ä¿®æ”¹å€¼

```javascript
import React, { useState } from "react";

function ClickCounter() {
  // æ•°ç»„çš„è§£æ„
  // useState å°±æ˜¯ä¸€ä¸ª Hook â€œé’©â€ï¼Œæœ€åŸºæœ¬çš„ä¸€ä¸ª Hook
  const [count, setCount] = useState(0); // ä¼ å…¥ä¸€ä¸ªåˆå§‹å€¼
  const [name, setName] = useState("oweqianè€å¸ˆ");

  function clickHandler() {
    setCount(count + 1);
    setName(name + "2020");
  }

  return (
    <div>
      <p>
        ä½ ç‚¹å‡»äº† {count} æ¬¡ {name}
      </p>
      <button onClick={clickHandler}>ç‚¹å‡»</button>
    </div>
  );
}

export default ClickCounter;
```

#### useEffect

- æ¨¡æ‹Ÿ componentDidMount - useEffect ä¾èµ– []
- æ¨¡æ‹Ÿ componentDidUpdate - useEffect æ— ä¾èµ–æˆ–ä¾èµ– [a, b]
- æ¨¡æ‹Ÿ componentWillUnMount - useEffect ä¸­è¿”å›ä¸€ä¸ªå‡½æ•°

```javascript
import React, { useState, useEffect } from "react";

function LifeCycles() {
  const [count, setCount] = useState(0);
  const [name, setName] = useState("oweqianè€å¸ˆ");

  // // æ¨¡æ‹Ÿ class ç»„ä»¶çš„ DidMount å’Œ DidUpdate
  // useEffect(() => {
  //     console.log('åœ¨æ­¤å‘é€ä¸€ä¸ª ajax è¯·æ±‚')
  // })

  // // æ¨¡æ‹Ÿ class ç»„ä»¶çš„ DidMount
  // useEffect(() => {
  //     console.log('åŠ è½½å®Œäº†')
  // }, []) // ç¬¬äºŒä¸ªå‚æ•°æ˜¯ [] ï¼ˆä¸ä¾èµ–äºä»»ä½• stateï¼‰

  // // æ¨¡æ‹Ÿ class ç»„ä»¶çš„ DidUpdate
  // useEffect(() => {
  //     console.log('æ›´æ–°äº†')
  // }, [count, name]) // ç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯ä¾èµ–çš„ state

  // æ¨¡æ‹Ÿ class ç»„ä»¶çš„ DidMount
  useEffect(() => {
    let timerId = setInterval(() => {
      console.log(Date.now());
    }, 1000);

    // è¿”å›ä¸€ä¸ªå‡½æ•°
    // æ¨¡æ‹Ÿ WillUnMount
    return () => {
      clearInterval(timerId);
    };
  }, []);

  function clickHandler() {
    setCount(count + 1);
    setName(name + "2020");
  }

  return (
    <div>
      <p>
        ä½ ç‚¹å‡»äº† {count} æ¬¡ {name}
      </p>
      <button onClick={clickHandler}>ç‚¹å‡»</button>
    </div>
  );
}

export default LifeCycles;
```

æ¨¡æ‹Ÿ willUnMountï¼Œä½†ä¸å®Œå…¨ç­‰åŒäº willUnMount

```javascript
// class component
componentDidMount() {
    console.log(`å¼€å§‹ç›‘å¬ ${this.props.friendId} çš„åœ¨çº¿çŠ¶æ€`)
}
componentWillUnMount() {
    console.log(`ç»“æŸç›‘å¬ ${this.props.friendId} çš„åœ¨çº¿çŠ¶æ€`)
}
// friendId æ›´æ–°
componentDidUpdate(prevProps) {
    console.log(`ç»“æŸç›‘å¬ ${prevProps.friendId} åœ¨çº¿çŠ¶æ€`)
    console.log(`å¼€å§‹ç›‘å¬ ${this.props.friendId} åœ¨çº¿çŠ¶æ€`)
}

// function component
// DidMount å’Œ DidUpdate
useEffect(() => {
    console.log(`å¼€å§‹ç›‘å¬ ${friendId} åœ¨çº¿çŠ¶æ€`)

    // ã€ç‰¹åˆ«æ³¨æ„ã€‘
    // æ­¤å¤„å¹¶ä¸å®Œå…¨ç­‰åŒäº WillUnMount
    // props å‘ç”Ÿå˜åŒ–ï¼Œå³æ›´æ–°ï¼Œä¹Ÿä¼šæ‰§è¡Œç»“æŸç›‘å¬
    // å‡†ç¡®çš„è¯´ï¼šè¿”å›çš„å‡½æ•°ï¼Œä¼šåœ¨ä¸‹ä¸€æ¬¡ effect æ‰§è¡Œä¹‹å‰ï¼Œè¢«æ‰§è¡Œ
    return () => {
        console.log(`ç»“æŸç›‘å¬ ${friendId} åœ¨çº¿çŠ¶æ€`)
    }
})

```

useEffect ä¸­è¿”å›å‡½æ•° fnï¼š

- useEffect ä¾èµ– []ï¼Œç»„ä»¶é”€æ¯æ—¶æ‰§è¡Œ fnï¼Œç­‰åŒäº willUnMount
- useEffect æ— ä¾èµ–æˆ–ä¾èµ– [a, b]ï¼Œç»„ä»¶æ›´æ–°æ—¶æ‰§è¡Œ fn
- **å³ï¼Œä¸‹ä¸€æ¬¡æ‰§è¡Œ useEffect ä¹‹å‰ï¼Œå°±ä¼šæ‰§è¡Œ fnï¼Œæ— è®ºæ›´æ–°æˆ–å¸è½½**

#### useRef

```javascript
import React, { useRef, useEffect } from "react";

function UseRef() {
  const btnRef = useRef(null); // åˆå§‹å€¼

  useEffect(() => {
    console.log(btnRef.current); // DOM èŠ‚ç‚¹
  }, []);

  return (
    <div>
      <button ref={btnRef}>click</button>
    </div>
  );
}

export default UseRef;
```

#### useContext

```javascript
import React, { useContext } from "react";

// ä¸»é¢˜é¢œè‰²
const themes = {
  light: {
    foreground: "#000",
    background: "#eee",
  },
  dark: {
    foreground: "#fff",
    background: "#222",
  },
};

// åˆ›å»º Context
const ThemeContext = React.createContext(themes.light); // åˆå§‹å€¼

function ThemeButton() {
  const theme = useContext(ThemeContext);

  return (
    <button style={{ background: theme.background, color: theme.foreground }}>
      hello world
    </button>
  );
}

function Toolbar() {
  return (
    <div>
      <ThemeButton></ThemeButton>
    </div>
  );
}

function App() {
  return (
    <ThemeContext.Provider value={themes.dark}>
      <Toolbar></Toolbar>
    </ThemeContext.Provider>
  );
}

export default App;
```

#### useReducer

```javascript
import React, { useReducer } from "react";

const initialState = { count: 0 };

const reducer = (state, action) => {
  switch (action.type) {
    case "increment":
      return { count: state.count + 1 };
    case "decrement":
      return { count: state.count - 1 };
    default:
      return state;
  }
};

function App() {
  const [state, dispatch] = useReducer(reducer, initialState);

  return (
    <div>
      count: {state.count}
      <button onClick={() => dispatch({ type: "increment" })}>increment</button>
      <button onClick={() => dispatch({ type: "decrement" })}>decrement</button>
    </div>
  );
}

export default App;
```

useReducer å’Œ Redux çš„åŒºåˆ«ï¼š

- useReducer æ˜¯ useState çš„ä»£æ›¿æ–¹æ¡ˆï¼Œç”¨äº state å¤æ‚å˜åŒ–
- useReducer æ˜¯å•ç»„ä»¶çŠ¶æ€ç®¡ç†ï¼Œç»„ä»¶é€šè®¯è¿˜éœ€è¦ props
- Redux æ˜¯å…¨å±€çŠ¶æ€ç®¡ç†ï¼Œå¤šç»„ä»¶å…±äº«æ•°æ®

#### useMemo

- React é»˜è®¤ä¼šæ›´æ–°æ‰€æœ‰å­ç»„ä»¶
- class ç»„ä»¶ä½¿ç”¨ SCU å’Œ PureComponent åšä¼˜åŒ–
- Hooks ä¸­ä½¿ç”¨ useMemoï¼Œä½†ä¼˜åŒ–çš„åŸç†æ˜¯ç›¸åŒçš„

```javascript
import React, { useState, memo, useMemo } from "react";

// å­ç»„ä»¶
// function Child({ userInfo }) {
//     console.log('Child render...', userInfo)

//     return <div>
//         <p>This is Child {userInfo.name} {userInfo.age}</p>
//     </div>
// }
// ç±»ä¼¼ class PureComponent ï¼Œå¯¹ props è¿›è¡Œæµ…å±‚æ¯”è¾ƒ
const Child = memo(({ userInfo }) => {
  console.log("Child render...", userInfo);

  return (
    <div>
      <p>
        This is Child {userInfo.name} {userInfo.age}
      </p>
    </div>
  );
});

// çˆ¶ç»„ä»¶
function App() {
  console.log("Parent render...");

  const [count, setCount] = useState(0);
  const [name, setName] = useState("oweqianè€å¸ˆ");

  // const userInfo = { name, age: 20 }
  // ç”¨ useMemo ç¼“å­˜æ•°æ®ï¼Œæœ‰ä¾èµ–
  const userInfo = useMemo(() => {
    return { name, age: 21 };
  }, [name]);

  return (
    <div>
      <p>
        count is {count}
        <button onClick={() => setCount(count + 1)}>click</button>
      </p>
      <Child userInfo={userInfo}></Child>
    </div>
  );
}

export default App;
```

#### useCallback

- useMemo ç¼“å­˜æ•°æ®
- useCallback ç¼“å­˜å‡½æ•°
- ä¸¤è€…æ˜¯ React Hooks çš„å¸¸è§ä¼˜åŒ–ç­–ç•¥ (æ­é… React.memo)

```javascript
import React, { useState, memo, useMemo, useCallback } from "react";

// å­ç»„ä»¶ï¼Œmemo ç›¸å½“äº PureComponent
const Child = memo(({ userInfo, onChange }) => {
  console.log("Child render...", userInfo);

  return (
    <div>
      <p>
        This is Child {userInfo.name} {userInfo.age}
      </p>
      <input onChange={onChange}></input>
    </div>
  );
});

// çˆ¶ç»„ä»¶
function App() {
  console.log("Parent render...");

  const [count, setCount] = useState(0);
  const [name, setName] = useState("oweqianè€å¸ˆ");

  // ç”¨ useMemo ç¼“å­˜æ•°æ®
  const userInfo = useMemo(() => {
    return { name, age: 21 };
  }, [name]);

  // function onChange(e) {
  //     console.log(e.target.value)
  // }
  // ç”¨ useCallback ç¼“å­˜å‡½æ•°
  const onChange = useCallback((e) => {
    console.log(e.target.value);
  }, []);

  return (
    <div>
      <p>
        count is {count}
        <button onClick={() => setCount(count + 1)}>click</button>
      </p>
      <Child userInfo={userInfo} onChange={onChange}></Child>
    </div>
  );
}

export default App;
```

#### è‡ªå®šä¹‰ Hook

- å°è£…é€šç”¨çš„åŠŸèƒ½
- å¼€å‘å’Œä½¿ç”¨ç¬¬ä¸‰æ–¹ Hooks
- è‡ªå®šä¹‰ Hook å¸¦æ¥äº†æ— é™çš„æ‰©å±•æ€§ï¼Œè§£è€¦ä»£ç 
- æœ¬è´¨æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä»¥ use å¼€å¤´
- å†…éƒ¨æ­£å¸¸ä½¿ç”¨ useStateã€useEffectã€å…¶å®ƒ Hooks
- è‡ªå®šä¹‰è¿”å›æ ¼å¼

```javascript
import { useState, useEffect } from "react";
import axios from "axios";

// å°è£… axios å‘é€ç½‘ç»œè¯·æ±‚çš„è‡ªå®šä¹‰ Hook
function useAxios(url) {
  const [loading, setLoading] = useState(false);
  const [data, setData] = useState();
  const [error, setError] = useState();

  useEffect(() => {
    // åˆ©ç”¨ axios å‘é€ç½‘ç»œè¯·æ±‚
    setLoading(true);
    axios
      .get(url) // å‘é€ä¸€ä¸ª get è¯·æ±‚
      .then((res) => setData(res))
      .catch((err) => setError(err))
      .finally(() => setLoading(false));
  }, [url]);

  return [loading, data, error];
}

export default useAxios;

// ç¬¬ä¸‰æ–¹ Hook
// https://nikgraf.github.io/react-hooks/
// https://github.com/umijs/hooks
```

```javascript
import Reactfrom 'react'
import useAxios from '../customHooks/useAxios'

function App() {
    const url = 'http://localhost:3000/'
    // æ•°ç»„è§£æ„
    const [loading, data, error] = useAxios(url)

    if (loading) return <div>loading...</div>

    return error
        ? <div>{JSON.stringify(error)}</div>
        : <div>{JSON.stringify(data)}</div>
}

export default App

```

#### æ€»ç»“

- å‘½åè§„èŒƒ useXxx
- Hooks ä½¿ç”¨è§„èŒƒï¼Œé‡è¦
- å…³äº Hooks çš„è°ƒç”¨é¡ºåº

#### ä½¿ç”¨è§„èŒƒ

- åªèƒ½ç”¨äº React å‡½æ•°ç»„ä»¶å’Œè‡ªå®šä¹‰ Hook ä¸­ï¼Œå…¶å®ƒåœ°æ–¹ä¸å¯ä»¥
- åªèƒ½ç”¨äºé¡¶å±‚ä»£ç ï¼Œä¸èƒ½åœ¨å¾ªç¯ã€åˆ¤æ–­ä¸­ä½¿ç”¨ Hooks
- eslint æ’ä»¶ eslint-plugin-react-hooks å¯ä»¥å¸®åˆ°ä½ 

#### Hooks è°ƒç”¨é¡ºåº

- å‡½æ•°ç»„ä»¶ï¼Œçº¯å‡½æ•°ï¼Œæ‰§è¡Œå®Œå³é”€æ¯
- æ— è®ºæ˜¯ render è¿˜æ˜¯ re-renderï¼ŒHooks è°ƒç”¨é¡ºåºå¿…é¡»ä¸€è‡´
- å¦‚æœ Hooks å‡ºç°åœ¨å¾ªç¯ã€åˆ¤æ–­é‡Œï¼Œåˆ™æ— æ³•ä¿è¯é¡ºåºä¸€è‡´
- Hooks ä¸¥é‡ä¾èµ–è°ƒç”¨é¡ºåºï¼é‡è¦ï¼

```javascript
import React, { useState, useEffect } from "react";

function Teach({ couseName }) {
  // å‡½æ•°ç»„ä»¶ï¼Œçº¯å‡½æ•°ï¼Œæ‰§è¡Œå®Œå³é”€æ¯
  // æ‰€ä»¥ï¼Œæ— è®ºç»„ä»¶åˆå§‹åŒ–ï¼ˆrenderï¼‰è¿˜æ˜¯ç»„ä»¶æ›´æ–°ï¼ˆre-renderï¼‰
  // éƒ½ä¼šé‡æ–°æ‰§è¡Œä¸€æ¬¡è¿™ä¸ªå‡½æ•°ï¼Œè·å–æœ€æ–°çš„ç»„ä»¶
  // è¿™ä¸€ç‚¹å’Œ class ç»„ä»¶ä¸ä¸€æ ·

  // render: åˆå§‹åŒ– state çš„å€¼ 'å¼ ä¸‰'
  // re-render: è¯»å– state çš„å€¼ 'å¼ ä¸‰'
  const [studentName, setStudentName] = useState("å¼ ä¸‰");

  // if (couseName) {
  //     const [studentName, setStudentName] = useState('å¼ ä¸‰')
  // }

  // render: åˆå§‹åŒ– state çš„å€¼ 'oweqian'
  // re-render: è¯»å– state çš„å€¼ 'oweqian'
  const [teacherName, setTeacherName] = useState("oweqian");

  // if (couseName) {
  //     useEffect(() => {
  //         // æ¨¡æ‹Ÿå­¦ç”Ÿç­¾åˆ°
  //         localStorage.setItem('name', studentName)
  //     })
  // }

  // render: æ·»åŠ  effect å‡½æ•°
  // re-render: æ›¿æ¢ effect å‡½æ•°ï¼ˆå†…éƒ¨çš„å‡½æ•°ä¼šé‡æ–°å®šä¹‰ï¼‰
  useEffect(() => {
    // æ¨¡æ‹Ÿå­¦ç”Ÿç­¾åˆ°
    localStorage.setItem("name", studentName);
  });

  // render: æ·»åŠ  effect å‡½æ•°
  // re-render: æ›¿æ¢ effect å‡½æ•°ï¼ˆå†…éƒ¨çš„å‡½æ•°ä¼šé‡æ–°å®šä¹‰ï¼‰
  useEffect(() => {
    // æ¨¡æ‹Ÿå¼€å§‹ä¸Šè¯¾
    console.log(`${teacherName} å¼€å§‹ä¸Šè¯¾ï¼Œå­¦ç”Ÿ ${studentName}`);
  });

  return (
    <div>
      è¯¾ç¨‹ï¼š{couseName}ï¼Œ è®²å¸ˆï¼š{teacherName}ï¼Œ å­¦ç”Ÿï¼š{studentName}
    </div>
  );
}

export default Teach;
```

#### class ç»„ä»¶é€»è¾‘å¤ç”¨

- é«˜é˜¶ç»„ä»¶ HOCï¼ˆç»„ä»¶åµŒå¥—ã€props é€ä¼ ï¼‰
- Render Propsï¼ˆå­¦ä¹ æˆæœ¬é«˜ï¼Œåªèƒ½ä¼ é€’çº¯å‡½æ•°ï¼‰

#### Hooks ç»„ä»¶é€»è¾‘å¤ç”¨

- å®Œå…¨ç¬¦åˆ Hooks åŸæœ‰è§„åˆ™ï¼Œæ²¡æœ‰å…¶ä»–è¦æ±‚ï¼Œæ˜“ç†è§£è®°å¿†
- å˜é‡ä½œç”¨åŸŸæ˜ç¡®
- ä¸ä¼šäº§ç”Ÿç»„ä»¶åµŒå¥—

```javascript
import { useState, useEffect } from "react";

function useMousePosition() {
  const [x, setX] = useState(0);
  const [y, setY] = useState(0);

  useEffect(() => {
    function mouseMoveHandler(event) {
      setX(event.clientX);
      setY(event.clientY);
    }

    // ç»‘å®šäº‹ä»¶
    document.body.addEventListener("mousemove", mouseMoveHandler);

    // è§£ç»‘äº‹ä»¶
    return () =>
      document.body.removeEventListener("mousemove", mouseMoveHandler);
  }, []);

  return [x, y];
}

export default useMousePosition;
```

#### æ³¨æ„äº‹é¡¹

- useState åˆå§‹åŒ–å€¼ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡æœ‰æ•ˆ

```javascript
import React, { useState } from "react";

// å­ç»„ä»¶
function Child({ userInfo }) {
  // render: åˆå§‹åŒ– state
  // re-render: åªæ¢å¤åˆå§‹åŒ–çš„ state å€¼ï¼Œä¸ä¼šå†é‡æ–°è®¾ç½®æ–°çš„å€¼
  //            åªèƒ½ç”¨ setName ä¿®æ”¹
  const [name, setName] = useState(userInfo.name);

  return (
    <div>
      <p>Child, props name: {userInfo.name}</p>
      <p>Child, state name: {name}</p>
    </div>
  );
}

function App() {
  const [name, setName] = useState("oweqian");
  const userInfo = { name };

  return (
    <div>
      <div>
        Parent &nbsp;
        <button onClick={() => setName("æ…•è¯¾ç½‘")}>setName</button>
      </div>
      <Child userInfo={userInfo} />
    </div>
  );
}

export default App;
```

- useEffect å†…éƒ¨ä¸èƒ½ä¿®æ”¹ state (é—­åŒ…)

```javascript
import React, { useState, useEffect } from "react";

function UseEffectChangeState() {
  const [count, setCount] = useState(0);

  // æ¨¡æ‹Ÿ DidMount
  // useEffectä¸­çš„çº¯å‡½æ•°æ‰§è¡Œå®Œåˆ™é”€æ¯ï¼Œé™¤éæ˜¯DidUpdate
  useEffect(() => {
    console.log("useEffect...", count);

    // å®šæ—¶ä»»åŠ¡
    const timer = setInterval(() => {
      console.log("setInterval...", count); // ä¼šä¸€ç›´è¾“å‡º0
      setCount(count + 1);
    }, 1000);

    // æ¸…é™¤å®šæ—¶ä»»åŠ¡
    return () => clearTimeout(timer);
  }, []); // ä¾èµ–ä¸º []

  // ä¾èµ–ä¸º [] æ—¶ï¼š re-render ä¸ä¼šé‡æ–°æ‰§è¡Œ effect å‡½æ•°
  // æ²¡æœ‰ä¾èµ–ï¼šre-render ä¼šé‡æ–°æ‰§è¡Œ effect å‡½æ•°

  return <div>count: {count}</div>;
}

export default UseEffectChangeState;
```

è§£å†³æ–¹æ³•ï¼š

```javascript
import React, { useState, useRef, useEffect } from "react";

function UseEffectChangeState() {
  const [count, setCount] = useState(0);

  // æ¨¡æ‹Ÿ DidMount
  const countRef = useRef(0); // å¢åŠ ä¸€ä¸ªuseRef
  useEffect(() => {
    console.log("useEffect...", count);

    // å®šæ—¶ä»»åŠ¡
    const timer = setInterval(() => {
      console.log("setInterval...", countRef.current);
      setCount(++countRef.current);
    }, 1000);

    // æ¸…é™¤å®šæ—¶ä»»åŠ¡
    return () => clearTimeout(timer);
  }, []);

  return <div>count: {count}</div>;
}

export default UseEffectChangeState;
```

- useEffect å¯èƒ½å‡ºç°æ­»å¾ªç¯ï¼ˆä¾èµ–é¡¹é‡Œæœ‰å¼•ç”¨ç±»å‹ï¼‰

<img src="%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB%2045ad321291ec41f4acbef82cb460d3c4/image%2014.png" alt="" width="100%" />

### çœŸé¢˜æ¼”ç»ƒ

#### ç»„ä»¶ä¹‹é—´å¦‚ä½•é€šè®¯

- çˆ¶å­ç»„ä»¶ props
- è‡ªå®šä¹‰äº‹ä»¶
- Redux å’Œ Context

#### JSX æœ¬è´¨æ˜¯ä»€ä¹ˆ

- createElement
- æ‰§è¡Œè¿”å› vnode

#### Context æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•åº”ç”¨

- çˆ¶ç»„ä»¶ï¼Œå‘å…¶ä¸‹æ‰€æœ‰å­å­™ç»„ä»¶ä¼ é€’ä¿¡æ¯
- å¦‚ä¸€äº›ç®€å•çš„å…¬å…±ä¿¡æ¯ï¼šä¸»é¢˜è‰²ã€è¯­è¨€ç­‰
- å¤æ‚çš„å…¬å…±ä¿¡æ¯ï¼Œè¯·ç”¨ Redux

#### shouldComponentUpate ç”¨é€”

- æ€§èƒ½ä¼˜åŒ–
- é…åˆ "ä¸å¯å˜å€¼" ä¸€èµ·ä½¿ç”¨ï¼Œå¦åˆ™å®¹æ˜“å‡ºé”™

#### ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ

- å•ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ
- çˆ¶å­ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ
- æ³¨æ„ SCU

#### Ajax åº”è¯¥æ”¾åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸ

- ComponentDidMount

#### æ¸²æŸ“åˆ—è¡¨ï¼Œä¸ºä½•ç”¨ key

- diff ç®—æ³•ä¸­ï¼Œé€šè¿‡ tag å’Œ key æ¥ç®—åˆ¤æ–­æ˜¯å¦æ˜¯ sameNode
- å‡å°‘æ¸²æŸ“æ¬¡æ•°ï¼Œæå‡æ¸²æŸ“æ€§èƒ½

#### å‡½æ•°ç»„ä»¶å’Œ class ç»„ä»¶çš„åŒºåˆ«

- çº¯å‡½æ•°ï¼Œè¾“å…¥ propsï¼Œè¾“å‡º JSX
- æ²¡æœ‰å®ä¾‹ï¼Œæ²¡æœ‰ç”Ÿå‘½å‘¨æœŸï¼Œæ²¡æœ‰ state
- ä¸èƒ½æ‰©å±•æ–¹æ³•

#### ä»€ä¹ˆæ˜¯å—æ§ç»„ä»¶

- è¡¨å•çš„ value å— state æ§åˆ¶
- éœ€è¦è‡ªè¡Œç›‘å¬ onChangeï¼Œæ›´æ–° state
- å¯¹æ¯”éå—æ§ç»„ä»¶

#### ä½•æ—¶ä½¿ç”¨å¼‚æ­¥ç»„ä»¶

- åŠ è½½å¤§ç»„ä»¶
- è·¯ç”±æ‡’åŠ è½½

#### å¤šä¸ªç»„ä»¶æœ‰å…¬å…±é€»è¾‘ï¼Œå¦‚ä½•æŠ½ç¦»

- HOC
- Render Props

#### Redux å¦‚ä½•è¿›è¡Œå¼‚æ­¥è¯·æ±‚

- ä½¿ç”¨å¼‚æ­¥ action
- å¦‚ redux-thunk

#### PureComponent æœ‰ä½•åŒºåˆ«

- å®ç°äº†æµ…æ¯”è¾ƒçš„ shouldComponentUpdate
- ä¼˜åŒ–æ€§èƒ½
- è¦ç»“åˆä¸å¯å˜å€¼ä½¿ç”¨

#### React äº‹ä»¶å’Œ DOM äº‹ä»¶çš„åŒºåˆ«

- æ‰€æœ‰äº‹ä»¶å‡æŒ‚è½½åˆ° root element ä¸Š
- event ä¸æ˜¯åŸç”Ÿçš„ï¼Œæ˜¯ SyntheticEvent åˆæˆäº‹ä»¶å¯¹è±¡
- dispatchEvent

#### æ€§èƒ½ä¼˜åŒ–

- æ¸²æŸ“åˆ—è¡¨æ—¶ä½¿ç”¨ key
- è‡ªå®šä¹‰äº‹ä»¶ã€DOM äº‹ä»¶åŠæ—¶é”€æ¯
- åˆç†ä½¿ç”¨å¼‚æ­¥ç»„ä»¶
- å‡å°‘å‡½æ•° bind this çš„æ¬¡æ•°
- åˆç†ä½¿ç”¨ SCUã€PureComponent å’Œ memo
- åˆç†ä½¿ç”¨ immutable.js
- webpack å±‚é¢çš„ä¼˜åŒ–
- å‰ç«¯é€šç”¨çš„æ€§èƒ½ä¼˜åŒ–(å›¾ç‰‡æ‡’åŠ è½½ç­‰)
- ä½¿ç”¨ SSR

#### React å’Œ Vue çš„åŒºåˆ«

ç›¸åŒç‚¹ï¼š

- éƒ½æ”¯æŒç»„ä»¶åŒ–
- éƒ½æ˜¯æ•°æ®é©±åŠ¨è§†å›¾
- éƒ½æœ‰è™šæ‹Ÿ DOM çš„æ¦‚å¿µ

ä¸åŒç‚¹ï¼š

- React ä½¿ç”¨ JSX æ‹¥æŠ± JSï¼ŒVue ä½¿ç”¨æ¨¡æ¿æ‹¥æŠ± html
- React æ˜¯å‡½æ•°å¼ç¼–ç¨‹ï¼ŒVue æ˜¯å£°æ˜å¼ç¼–ç¨‹
- React æ›´é€‚åˆå¤§å‹ä¸šåŠ¡å¼€å‘ï¼ŒVue æ›´é€‚åˆä¸­å°å‹ä¸šåŠ¡å¼€å‘

#### ä¸ºä»€ä¹ˆä¼šæœ‰ React Hooksï¼Œå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜

- å®Œå–„å‡½æ•°ç»„ä»¶çš„èƒ½åŠ›ï¼Œå‡½æ•°æ›´é€‚åˆ React ç»„ä»¶
- ç»„ä»¶é€»è¾‘å¤ç”¨ï¼ŒHooks è¡¨ç°æ›´å¥½
- class ç»„ä»¶å¤æ‚ï¼Œä¸æ˜“æ‹†è§£ï¼Œä¸æ˜“æµ‹è¯•ï¼Œé€»è¾‘æ··ä¹±

#### React Hooks å¦‚ä½•æ¨¡æ‹Ÿç»„ä»¶ç”Ÿå‘½å‘¨æœŸ

- æ¨¡æ‹Ÿ componentDidMount - useEffect ä¾èµ– []
- æ¨¡æ‹Ÿ componentDidUpdate - useEffect æ— ä¾èµ–æˆ–ä¾èµ– [a, b]
- æ¨¡æ‹Ÿ componentWillUnMount - useEffect ä¸­è¿”å›ä¸€ä¸ªå‡½æ•°

#### React Hooks æ€§èƒ½ä¼˜åŒ–

- useMemo ç¼“å­˜æ•°æ®
- useCallback ç¼“å­˜å‡½æ•°

#### ä½¿ç”¨ React Hooks é‡åˆ°å“ªäº›å‘

- useState åˆå§‹åŒ–å€¼ï¼Œåªåˆå§‹åŒ–ä¸€æ¬¡
- useEffect å†…éƒ¨ä¸èƒ½ä¿®æ”¹ state
- useEffect ä¾èµ–å¼•ç”¨ç±»å‹ï¼Œä¼šå‡ºç°æ­»å¾ªç¯

#### Hooks ç›¸æ¯” HOC å’Œ Render Props æœ‰å“ªäº›ä¼˜ç‚¹

- å®Œå…¨ç¬¦åˆ Hooks åŸæœ‰è§„åˆ™ï¼Œæ²¡æœ‰å…¶ä»–è¦æ±‚ï¼Œæ˜“ç†è§£è®°å¿†
- å˜é‡ä½œç”¨åŸŸå¾ˆæ˜ç¡®
- ä¸ä¼šäº§ç”Ÿç»„ä»¶åµŒå¥—

## TypeScript

### TS ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Œé€‚ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆ

ä¼˜ç‚¹ï¼š

- é™æ€ç±»å‹æ£€æŸ¥ï¼Œç¼–è¯‘æ—¶æŠ¥é”™
- æ™ºèƒ½æç¤ºï¼Œæé«˜å¼€å‘æ•ˆç‡å’Œç¨³å®šæ€§

ç¼ºç‚¹ï¼š

- æœ‰ä¸€å®šå­¦ä¹ æˆæœ¬
- åº”ç”¨ä¸è§„èŒƒï¼Œâ€œanyscriptâ€

é€‚ç”¨åœºæ™¯ï¼š

- å¤§å‹é¡¹ç›®ã€ä¸šåŠ¡å¤æ‚ã€ç»´æŠ¤äººå‘˜å¤š
- é€»è¾‘æ€§è¾ƒå¼ºçš„ä»£ç ï¼Œéœ€è¦ç±»å‹æ›´ç¨³å›º

### TS åŸºç¡€ç±»å‹æœ‰å“ªäº›

- boolean
- number
- string
- null
- undefined
- symbol
- æ•°ç»„ Array
- å…ƒç»„ Tuple
- æšä¸¾ enum
- interface

### any void unknown never çš„åŒºåˆ«

- anyï¼šä¸è¿›è¡Œç±»å‹æ£€æŸ¥
- voidï¼šå‡½æ•°æ²¡æœ‰æ˜¾å¼è¿”å›ä¸€ä¸ªå€¼
- unknownï¼šæœªçŸ¥ç±»å‹ï¼ˆæœ‰ç±»å‹æ£€æŸ¥ï¼‰
- neverï¼šæ°¸è¿œä¸å­˜åœ¨çš„ç±»å‹

### TS çš„è®¿é—®ä¿®é¥°ç¬¦æœ‰å“ªå‡ ä¸ª

- public - å…¨éƒ¨å¯è®¿é—®
- private - åªæœ‰è‡ªå·±å¯è®¿é—®
- protected - è‡ªå·±å’Œæ´¾ç”Ÿç±»å¯è®¿é—®

### TS ç§æœ‰å±æ€§ # å’Œ private æœ‰ä»€ä¹ˆåŒºåˆ«

- ç§æœ‰å±æ€§ï¼Œä¸èƒ½åœ¨æ„é€ å‡½æ•°çš„å‚æ•°ä¸­å®šä¹‰
- private å±æ€§ï¼Œå¯ä»¥é€šè¿‡ as any å¼ºåˆ¶è·å–ï¼Œä½†ç§æœ‰å±æ€§ä¸è¡Œ

### type å’Œ interface çš„åŒºåˆ«ï¼Œä»¥åŠä½¿ç”¨åœºæ™¯

å…±åŒç‚¹ï¼š

- éƒ½å¯ä»¥æè¿°ä¸€ä¸ªå¯¹è±¡ç»“æ„
- éƒ½å¯ä»¥è¢« class å®ç°
- éƒ½å¯ä»¥è¢«æ‰©å±•

ä¸åŒç‚¹ï¼š

- type å¯ä»¥å£°æ˜åŸºç¡€ç±»å‹
- **type å¯ä»¥ä½¿ç”¨è”åˆç±»å‹ï¼ˆæˆ–ï¼‰ã€äº¤å‰ç±»å‹ï¼ˆåˆå¹¶ï¼‰**
- type å¯ä»¥é€šè¿‡ typeofã€keyof ç­‰èµ‹å€¼

### TS ä¸­äº¤å‰ç±»å‹å’Œè”åˆç±»å‹æ˜¯ä»€ä¹ˆ

äº¤å‰ç±»å‹ï¼š

- å¤šä¸ªç±»å‹åˆå¹¶ä¸ºä¸€ä¸ªç±»å‹ T1 & T2 & T3
- å¦‚æœå±æ€§ç±»å‹å†²çªäº†ï¼Œåˆ™å±æ€§ç±»å‹ä¸º never
- åŸºç¡€ç±»å‹æ— æ³•äº¤å‰ï¼Œä¼šè¿”å› never

è”åˆç±»å‹ï¼š

- è”åˆå¤šä¸ªç±»å‹ T1 | T2 | T3
- ä¸€ç§ â€œæˆ–â€ çš„å…³ç³»
- åŸºç¡€ç±»å‹å¯ä»¥è”åˆ

### TS ä¸­æœ‰å“ªäº›ç‰¹æ®Šç¬¦å·ï¼Œåˆ†åˆ«æ˜¯ä»€ä¹ˆæ„æ€

- ?ï¼šå¯é€‰
- ?.ï¼šå¯é€‰é“¾
- ??ï¼šç©ºå€¼åˆå¹¶è¿ç®—ç¬¦
- !ï¼šéç©ºæ–­è¨€æ“ä½œç¬¦
- \_ï¼šæ•°å­—åˆ†éš”ç¬¦

### TS å¸¸è§å·¥å…·ç±»å‹æœ‰å“ªäº›

- Partial<T>
- Required<T>
- Pick<T, K>
- Omit<T, K>
- Readonly<T>

### å¦‚ä½•æ‰©å±• window å±æ€§

```jsx
// interface åˆå¹¶å£°æ˜
declare interface Window {
  test: string;
}

window.test = "xxx";
```

### TS å¦‚ä½•å¤„ç†ç¬¬ä¸‰æ–¹æ¨¡å—çš„ç±»å‹

- å¸¸è§çš„ç¬¬ä¸‰æ–¹æ’ä»¶ï¼Œéƒ½æœ‰ `@types/xxx` åŒ…ï¼Œå®‰è£…å³å¯ä½¿ç”¨
- å¤–éƒ¨æ¨¡å—ï¼Œå¯é€šè¿‡ declare module
- å†…éƒ¨æ¨¡å—ï¼Œå¯é€šè¿‡ namespace å‘½åç©ºé—´
